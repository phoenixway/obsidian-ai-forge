/* ==========================================================================
   MAIN LAYOUT & CONTAINERS
   ========================================================================== */

   .ollama-container {
    display: flex;
    flex-direction: column;
    height: 100%;
    position: relative; /* Потрібно для позиціонування empty state та меню */
    background-color: var(--background-secondary-alt); /* Фон для всього контейнера */
  }
  
  .ollama-chat-container {
    flex: 1; /* Займає весь доступний простір по висоті */
    overflow-y: auto; /* Дозволяє вертикальну прокрутку */
    padding: 15px;
    padding-bottom: 5px; /* Залишаємо невеликий відступ знизу */
    box-sizing: border-box;
    /* background-color: var(--background-secondary-alt); -- Перенесено на .ollama-container */
    scroll-behavior: smooth; /* Плавна прокрутка */
    overscroll-behavior: contain; /* Запобігає скролу сторінки при досягненні краю */
  }
  
  /* Забезпечує правильне розтягування контейнера в Obsidian */
  .workspace-leaf-content[data-type='ollama-chat-view'] {
    display: flex;
    flex-direction: column;
    overflow: hidden; /* Запобігає подвійним скролбарам */
  }
  
  .workspace-leaf-content[data-type='ollama-chat-view'] .view-content {
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden; /* Запобігає подвійним скролбарам */
  }
  
  /* Empty state styling */
  .ollama-empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    width: 100%;
    position: absolute; /* Абсолютне позиціонування для накладання */
    top: 0;
    left: 0;
    text-align: center;
    color: var(--text-muted);
    padding: 20px;
    box-sizing: border-box;
    z-index: 1; /* Щоб бути під полем вводу */
    /* background-color: var(--background-secondary-alt); -- Успадковується від .ollama-container */
    pointer-events: none; /* Не заважає клікам на чат, якщо він під ним */
  }
  
  .empty-state-message {
    font-size: 18px;
    margin-bottom: 10px;
    opacity: 0.7;
  }
  
  .empty-state-tip {
    font-size: 14px;
    opacity: 0.5;
    max-width: 80%;
  }
  
  /* ==========================================================================
     CHAT INPUT SECTION (Button Styles Refined)
     ========================================================================== */
  
  .chat-input-container {
    display: flex;
    align-items: flex-start; /* Вирівнюємо елементи по верху */
    padding: 10px 15px;
    border-top: 1px solid var(--divider-color);
    background-color: var(--background-secondary-alt);
    z-index: 10; /* Щоб бути над empty state та чатом */
    border-radius: 12px; /* Трохи менш заокруглені кути */
    margin: 10px 15px;
    margin-top: 0; /* Прибираємо верхній відступ, бо контейнер чату має padding-bottom */
    margin-bottom: 5px; /* Менший відступ знизу */
    box-sizing: border-box;
    /* Тінь трохи м'якша */
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
    position: relative; /* Для позиціонування кнопок */
    flex-shrink: 0; /* Забороняємо контейнеру стискатися */
  }
  
  .chat-input-container textarea {
    flex: 1; /* Займає доступний простір */
    resize: none; /* Забороняємо ручне змінення розміру */
    border: none; /* Прибираємо стандартну рамку */
    border-radius: 8px; /* Узгоджуємо радіус */
    padding: 10px 15px;
    /* Динамічний відступ справа, залежить від кількості кнопок.
       Потрібно розрахувати приблизно: (ширина_кнопки + відступ) * к-сть + невеликий_запас */
    padding-right: 120px; /* Орієнтовно для 3 кнопок (32+8)*3 + 20 */
    margin-right: 0;
    min-height: 40px; /* Мінімальна висота */
    max-height: 60vh; /* Обмежуємо максимальну висоту */
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-size: 14px;
    line-height: 1.5; /* Покращуємо читабельність */
    transition: border-color 0.3s, box-shadow 0.3s, height 0.2s ease-in-out; /* Додаємо ease */
    overflow-y: auto; /* Дозволяємо скрол, якщо max-height досягнуто */
    width: 100%;
    box-shadow: inset 0 1px 2px rgba(0,0,0,0.05); /* Внутрішня тінь для глибини */
    box-sizing: border-box; /* Включаємо padding в розмір */
  }
  
  /* Стиль для видимості фокусу на textarea */
  .chat-input-container textarea:focus {
    outline: none;
    box-shadow: inset 0 1px 2px rgba(0,0,0,0.05), 0 0 0 2px var(--interactive-accent-translucent); /* Ефект фокусу */
  }
  
  .buttons-container {
    display: flex;
    position: absolute;
    /* Позиціонуємо ближче до низу */
    bottom: 10px;
    right: 15px;
    /* Видаляємо transform, бо bottom тепер фіксований */
    align-items: center;
    z-index: 11; /* Над textarea */
    gap: 8px; /* Простір між кнопками за допомогою gap */
  }
  
  /* --- Базовий стиль для всіх кнопок --- */
  .buttons-container button {
    width: 32px;
    height: 32px;
    border: none;
    border-radius: 50%; /* Зберігаємо круглу форму */
    background-color: transparent; /* Робимо прозорими за замовчуванням */
    color: var(--text-muted); /* Приглушений колір іконки */
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0; /* Скидаємо внутрішні відступи */
    transition: all 0.15s ease-in-out; /* Швидша, плавна анімація */
    opacity: 0.7; /* Трохи прозорі */
    outline: none; /* Прибираємо стандартний контур */
    flex-shrink: 0; /* Запобігаємо стисканню кнопок */
  }
  
  /* Ефекти при наведенні/фокусі для всіх кнопок */
  .buttons-container button:hover {
    background-color: var(--background-modifier-hover); /* Фон при наведенні */
    color: var(--text-normal); /* Яскравіший колір іконки */
    opacity: 1; /* Повна непрозорість */
    transform: scale(1.05); /* Невелике збільшення */
  }
  
  /* Стиль для стану фокусу (важливо для доступності) */
  .buttons-container button:focus-visible {
    opacity: 1;
    background-color: var(--background-modifier-hover);
    box-shadow: 0 0 0 2px var(--interactive-accent-translucent); /* Кільце фокусу */
  }
  
  /* --- Кнопка Відправки (Send) --- */
  .buttons-container .send-button {
    background-color: var(--interactive-accent); /* Основний колір */
    color: var(--text-on-accent); /* Колір іконки на акцентному фоні */
    opacity: 1; /* Завжди видима */
    box-shadow: 0 1px 3px rgba(var(--interactive-accent-rgb), 0.2); /* Тінь в колір кнопки */
  }
  
  .buttons-container .send-button:hover {
    background-color: var(--interactive-accent-hover); /* Колір при наведенні */
    transform: scale(1.08); /* Трохи більше збільшення */
    box-shadow: 0 2px 6px rgba(var(--interactive-accent-rgb), 0.3);
  }
  
  .buttons-container .send-button:active {
    transform: scale(1.02); /* Ефект натискання */
    background-color: var(--interactive-accent);
  }
  
  /* --- Кнопка Голосового Вводу (Voice) --- */
  /* (Успадковує базові стилі, потрібні тільки специфічні) */
  
  .buttons-container .voice-button.recording {
    background-color: var(--text-error); /* Червоний фон під час запису */
    color: white;
    opacity: 1;
    animation: pulse-recording 1.5s infinite ease-in-out;
    box-shadow: 0 0 0 0 rgba(var(--text-error-rgb), 0.5); /* Початкова тінь для анімації */
  }
  
  /* Покращена анімація пульсації для запису */
  @keyframes pulse-recording {
    0% {
      transform: scale(1);
      box-shadow: 0 0 0 0 rgba(var(--text-error-rgb), 0.5);
    }
    70% {
      transform: scale(1.05); /* Менший масштаб */
      box-shadow: 0 0 0 6px rgba(var(--text-error-rgb), 0); /* Тінь розширюється і зникає */
    }
    100% {
      transform: scale(1);
      box-shadow: 0 0 0 0 rgba(var(--text-error-rgb), 0);
    }
  }
  
  /* --- Кнопка Меню (Menu) --- */
  /* (Успадковує базові стилі) */
  
  
  /* ==========================================================================
     REGULAR MESSAGE STYLING (ENHANCED)
     ========================================================================== */
  
  .ollama-chat-container .message-group {
    display: flex;
    flex-direction: column;
    width: 100%;
    margin-bottom: 5px; /* Зменшений відступ між групами */
  }
  
  .ollama-chat-container .user-message-group {
    align-items: flex-end; /* Повідомлення користувача справа */
  }
  
  .ollama-chat-container .ollama-message-group {
    align-items: flex-start; /* Повідомлення асистента зліва */
  }
  
  .ollama-chat-container .message {
    /* Відступ лише між повідомленнями В межах однієї групи */
    margin-bottom: 2px;
    padding: 10px 15px;
    border-radius: 18px; /* Більш заокруглені повідомлення */
    max-width: 80%; /* Трохи ширші повідомлення */
    word-wrap: break-word; /* Перенос слів */
    position: relative; /* Для псевдоелементів (хвостиків) та копіювання */
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); /* М'яка тінь */
    font-size: 14px;
    line-height: 1.45; /* Трохи більша міжрядкова відстань */
    transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
  }
  
  /* Стилізація послідовних повідомлень в групі */
  .message-group .message:not(:last-child) {
      /* Змінюємо радіус кутів для внутрішніх повідомлень */
  }
  .user-message-group .message:not(:last-child) {
      border-bottom-right-radius: 5px;
  }
  .ollama-message-group .message:not(:last-child) {
      border-bottom-left-radius: 5px;
  }
  /* Останнє повідомлення в групі */
  .message-group .message:last-child {
     margin-bottom: 10px; /* Відступ після всієї групи */
  }
  
  
  /* Enhanced user messages using theme variables */
  .ollama-chat-container .user-message {
    background-color: var(--interactive-accent);
    /* Використовуємо градієнт для більшої глибини */
    background-image: linear-gradient(135deg, var(--interactive-accent) 0%, var(--interactive-accent-hover) 100%);
    color: var(--text-on-accent);
    align-self: flex-end; /* Вирівнювання по правому краю */
    /* Заокруглення кутів */
    border-top-left-radius: 18px;
    border-bottom-left-radius: 18px;
    border-top-right-radius: 18px;
    /* border-bottom-right-radius: 5px; -- Змінено для видалення "хвостика" */
    box-shadow: 0 2px 5px rgba(var(--interactive-accent-rgb), 0.25);
  }
  .ollama-chat-container .user-message-group .message:last-child.user-message {
    /* border-bottom-right-radius: 18px; -- Не потрібне без "хвостика" */
  }
  
  
  .ollama-chat-container .user-message:hover {
    box-shadow: 0 4px 8px rgba(var(--interactive-accent-rgb), 0.3);
    transform: translateY(-1px); /* Легкий підйом при наведенні */
  }
  
  .ollama-chat-container .user-message .message-timestamp {
    color: var(--text-on-accent);
    opacity: 0.8;
  }
  
  .ollama-chat-container .user-message .copy-button {
    color: var(--text-on-accent) !important;
    opacity: 0.6 !important; /* Зробимо трохи виднішим */
  }
  
  .ollama-chat-container .user-message .copy-button:hover {
    opacity: 1 !important;
    background-color: rgba(255, 255, 255, 0.2) !important; /* Прозорий білий фон */
  }
  
  /* Enhanced AI messages */
  .ollama-chat-container .ollama-message {
    background-color: var(--background-primary); /* Використовуємо основний фон */
    color: var(--text-normal);
    align-self: flex-start; /* Вирівнювання по лівому краю */
    /* Заокруглення кутів */
    border-top-right-radius: 18px;
    border-bottom-right-radius: 18px;
    border-top-left-radius: 18px;
    /* border-bottom-left-radius: 5px; -- Змінено для видалення "хвостика" */
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.08);
  }
  .ollama-chat-container .ollama-message-group .message:last-child.ollama-message {
   /* border-bottom-left-radius: 18px; -- Не потрібне без "хвостика" */
  }
  
  
  .ollama-chat-container .ollama-message:hover {
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.12);
    transform: translateY(-1px);
  }
  
  /* --- Хвостики повідомлень (Speech bubble tails) --- */
  /* Видалені для більш чистого вигляду. Якщо потрібні, розкоментуйте відповідні секції вище та нижче. */
  
  /* --- Вміст повідомлення та метадані --- */
  
  .message-content-container {
    display: flex; /* Для розміщення копі-кнопки */
    align-items: flex-start; /* Вирівнювання по верху */
    width: 100%;
    position: relative; /* Для позиціонування копі-кнопки */
  }
  
  .message-content {
    flex: 1; /* Основний контент займає доступний простір */
    padding-right: 25px; /* Залишаємо місце для кнопки копіювання */
    min-width: 0; /* Дозволяє контенту стискатися і переносити текст */
  }
  
  .message-timestamp {
    font-size: 10px;
    color: var(--text-muted);
    margin-top: 5px; /* Відступ зверху */
    text-align: right; /* Вирівнювання часу справа під повідомленням */
    display: block; /* Щоб зайняти весь рядок */
    width: 100%;
    opacity: 0.7;
    clear: both; /* Щоб час не налізав на float елементи, якщо вони будуть */
  }
  /* Специфічний колір для часу в повідомленні користувача */
  .user-message .message-timestamp {
    color: var(--text-on-accent);
    opacity: 0.75;
  }
  
  .message-sender { /* Якщо потрібно відображати ім'я відправника */
    font-size: 12px;
    font-weight: bold;
    margin-bottom: 4px;
    color: var(--text-accent);
  }
  
  /* ==========================================================================
     SYSTEM MESSAGES (MORE EXPRESSIVE)
     ========================================================================== */
  
  .system-message-group {
    display: flex;
    flex-direction: column;
    align-items: center; /* Центруємо системні повідомлення */
    margin: 15px 0;
  }
  
  .system-message {
    background: var(--background-secondary); /* Трохи інший фон */
    color: var(--text-muted); /* Приглушений текст */
    border-left: 3px solid var(--interactive-accent); /* Акцентна лінія зліва */
    font-style: italic;
    padding: 8px 12px;
    border-radius: 8px;
    max-width: 90%;
    display: flex !important; /* Використовуємо flex для іконки та тексту */
    align-items: center !important;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05) !important;
    position: relative;
  }
  
  .system-bubble { /* Якщо використовується */
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1) !important;
  }
  
  .system-icon { /* Якщо використовується іконка */
    color: var(--interactive-accent);
    display: inline-flex;
    align-items: center;
    margin-right: 8px;
    font-size: 1em;
    flex-shrink: 0;
  }
  
  .system-message-text {
    display: inline;
    line-height: 1.4;
    font-size: 0.9em; /* Трохи менший шрифт */
    min-width: 0; /* Дозволяє тексту переноситися */
  }
  
  /* ==========================================================================
     ERROR MESSAGES (MOST EXPRESSIVE)
     ========================================================================== */
  
  .error-message-group {
    margin: 15px 0 !important;
    display: flex;
    flex-direction: column;
    align-items: center; /* Повідомлення про помилку також центруємо */
  }
  
  .error-message {
    background: var(--background-modifier-error) !important; /* Фон помилки з теми */
    color: var(--text-on-error) !important; /* Текст на фоні помилки */
    border-left: 3px solid var(--text-error) !important; /* Яскрава ліва межа */
    font-weight: 500 !important;
    padding: 10px 15px !important;
    max-width: 90% !important;
    position: relative;
    box-shadow: 0 2px 8px rgba(var(--text-error-rgb), 0.25) !important;
    border-radius: 8px !important;
    display: flex !important;
    align-items: center !important;
  }
  
  .error-bubble { /* Якщо використовується */
    box-shadow: 0 2px 8px rgba(var(--text-error-rgb), 0.3) !important;
  }
  
  .error-icon { /* Іконка для помилки */
    color: var(--text-error) !important; /* Яскравий колір іконки */
    margin-right: 10px !important;
    display: inline-flex !important;
    align-items: center !important;
    font-size: 1.1em !important;
    flex-shrink: 0;
  }
  
  .error-message-text {
    display: inline !important;
    line-height: 1.4 !important;
    color: var(--text-on-error) !important;
    font-weight: normal !important; /* Звичайний шрифт */
    font-size: 0.95em !important;
    min-width: 0; /* Дозволяє тексту переноситися */
  }
  
  /* Анімація при появі останнього повідомлення про помилку */
  @keyframes error-pulse {
    0% { box-shadow: 0 2px 8px rgba(var(--text-error-rgb), 0.25); }
    50% { box-shadow: 0 3px 12px 3px rgba(var(--text-error-rgb), 0.4); }
    100% { box-shadow: 0 2px 8px rgba(var(--text-error-rgb), 0.25); }
  }
  
  .error-message-group:last-child .error-message {
    animation: error-pulse 1.5s ease-out 1 !important;
  }
  
  /* ==========================================================================
     COPY BUTTON & UTILITIES
     ========================================================================== */
  
  .copy-button {
    position: absolute; /* Абсолютне позиціонування всередині content-container */
    top: 5px; /* Відступ зверху */
    right: 5px; /* Відступ справа */
    background: none !important;
    border: none !important;
    outline: none !important;
    color: var(--text-muted) !important;
    font-size: 12px !important; /* Збільшимо розмір іконки */
    cursor: pointer;
    opacity: 0 !important; /* Прихована за замовчуванням */
    transition: opacity 0.2s ease-in-out, background-color 0.2s ease-in-out !important;
    padding: 3px !important; /* Невеликий внутрішній відступ */
    border-radius: 4px; /* Заокруглення */
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px !important; /* Розмір кнопки */
    height: 20px !important;
    z-index: 1; /* Над текстом */
  }
  
  /* Показуємо кнопку копіювання при наведенні на повідомлення */
  .message:hover .copy-button {
    opacity: 0.6 !important; /* Показуємо при наведенні на батьківський елемент */
  }
  
  .copy-button:hover {
    opacity: 1 !important; /* Повна видимість при наведенні на саму кнопку */
    background-color: var(--background-modifier-hover) !important; /* Фон при наведенні */
  }
  /* Стилізація кнопки копіювання в повідомленні користувача */
  .user-message:hover .copy-button {
     color: var(--text-on-accent) !important;
     opacity: 0.6 !important;
  }
  
  
  /* ==========================================================================
     LOADING & THINKING INDICATORS
     ========================================================================== */
  
  /* Якщо потрібен окремий індикатор завантаження (не крапки) */
  .loading-indicator {
    display: inline-block;
    width: 16px;
    height: 16px;
    border: 2px solid var(--text-muted);
    border-top-color: var(--interactive-accent);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-left: 10px;
  }
  
  @keyframes spin {
    to { transform: rotate(360deg); }
  }
  
  /* Анімовані крапки "Thinking..." в повідомленні Ollama */
  .ollama-message .thinking-dots {
    display: flex;
    align-items: center;
    justify-content: flex-start; /* Вирівнюємо по лівому краю */
    padding: 8px 0; /* Вертикальний відступ */
  }
  /* Анімовані крапки в окремому блоці завантаження */
  .ollama-chat-container > .message-group.ollama-message-group .thinking-dots {
      justify-content: center; /* Центруємо, якщо це єдиний вміст */
  }
  
  
  .thinking-dot {
    width: 7px; /* Трохи менші крапки */
    height: 7px;
    border-radius: 50%;
    background-color: var(--text-muted);
    margin: 0 3px;
    opacity: 0.6;
    animation: dot-pulse 1.4s infinite ease-in-out; /* Трохи швидша анімація */
  }
  
  .thinking-dot:nth-child(1) { animation-delay: 0s; }
  .thinking-dot:nth-child(2) { animation-delay: 0.2s; } /* Менша затримка */
  .thinking-dot:nth-child(3) { animation-delay: 0.4s; }
  
  @keyframes dot-pulse {
    0%, 80%, 100% {
      transform: scale(0.8); /* Зменшуємо базовий розмір */
      opacity: 0.4;
    }
    40% {
      transform: scale(1.2); /* Збільшуємо піковий розмір */
      opacity: 1;
    }
  }
  
  /* Блок <thinking> */
  .thinking-block {
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    margin: 10px 0; /* Зменшені відступи */
    background-color: var(--background-secondary-alt); /* Інший фон для виділення */
    overflow: hidden; /* Щоб внутрішні елементи не виходили за межі */
  }
  
  .thinking-header {
    background-color: var(--background-modifier-hover); /* Менш яскравий фон */
    color: var(--text-muted);
    padding: 6px 10px; /* Зменшені відступи */
    display: flex;
    align-items: center;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.2s;
  }
  .thinking-header:hover {
      background-color: var(--background-modifier-border);
  }
  
  .thinking-toggle {
    margin-right: 6px;
    font-weight: bold;
    transition: transform 0.2s ease-in-out;
    font-size: 0.9em;
  }
  /* Стилізація стрілки в залежності від стану */
  .thinking-header[data-fold-state="expanded"] .thinking-toggle {
    transform: rotate(90deg);
  }
  
  .thinking-title {
    font-weight: 500; /* Менш жирний шрифт */
    font-size: 0.9em;
  }
  
  .thinking-content {
    padding: 10px 12px;
    white-space: pre-wrap; /* Збереження переносів рядків і пробілів */
    overflow-x: auto; /* Горизонтальний скрол при потребі */
    line-height: 1.5;
    border-top: 1px solid var(--background-modifier-border);
    background-color: var(--background-primary); /* Основний фон для вмісту */
    font-size: 0.9em; /* Трохи менший шрифт */
    color: var(--text-normal);
  }
  /* Стилі для коду всередині thinking */
  .thinking-content pre {
    background-color: var(--background-secondary) !important;
  }
  .thinking-content code {
     background-color: var(--background-modifier-hover) !important;
  }
  
  
  /* ==========================================================================
     MARKDOWN CONTENT IN MESSAGES
     ========================================================================== */
  
  .ollama-message .message-content {
    width: 100%; /* Займає всю ширину контейнера */
  }
  
  .ollama-message .message-content > *:first-child {
    margin-top: 0; /* Прибираємо верхній відступ у першого елемента */
  }
  
  .ollama-message .message-content > *:last-child {
    margin-bottom: 0; /* Прибираємо нижній відступ у останнього елемента */
  }
  
  .ollama-message .message-content p {
    margin: 0.6em 0; /* Стандартні відступи для параграфів */
    line-height: 1.5; /* Міжрядковий інтервал */
    word-wrap: break-word; /* Дозволяє переносити дуже довгі слова */
  }
  
  .ollama-message .message-content ul,
  .ollama-message .message-content ol {
    margin: 0.6em 0;
    padding-left: 1.8em; /* Відступ для списків */
  }
  .ollama-message .message-content li {
      margin-bottom: 0.3em; /* Відступ між елементами списку */
  }
  
  .ollama-message .message-content pre {
    background-color: var(--background-secondary); /* Фон для блоків коду */
    border-radius: 6px;
    padding: 12px; /* Внутрішні відступи */
    margin: 0.8em 0;
    overflow-x: auto; /* Горизонтальний скрол для довгого коду */
    border: 1px solid var(--background-modifier-border); /* Легка рамка */
    font-size: 0.9em; /* Трохи менший шрифт коду */
    line-height: 1.4; /* Міжрядковий інтервал для коду */
  }
  
  .ollama-message .message-content code {
    font-family: var(--font-monospace); /* Моноширинний шрифт */
    font-size: 0.9em;
    background-color: var(--background-modifier-hover); /* Фон для вбудованого коду */
    padding: 0.2em 0.4em;
    border-radius: 4px;
    word-break: break-all; /* Примусовий перенос для дуже довгих слів в коді */
    color: var(--text-normal); /* Явний колір тексту */
  }
  
  .ollama-message .message-content pre code {
    padding: 0; /* Скидаємо відступи для коду всередині <pre> */
    background-color: transparent; /* Фон вже є у <pre> */
    font-size: inherit; /* Успадковуємо розмір шрифту від <pre> */
    border-radius: 0;
    word-break: normal; /* Скасовуємо примусовий перенос всередині pre */
    color: inherit; /* Успадковуємо колір тексту від <pre> */
  }
  
  .ollama-message .message-content blockquote {
    border-left: 3px solid var(--interactive-accent); /* Акцентна лінія для цитат */
    margin: 0.8em 0;
    padding: 0.5em 1.2em; /* Відступи всередині цитати */
    color: var(--text-muted); /* Приглушений колір тексту цитати */
    background-color: var(--background-secondary-alt); /* Легкий фон */
    border-radius: 0 6px 6px 0; /* Заокруглення */
  }
  .ollama-message .message-content blockquote p {
      margin: 0.4em 0; /* Відступи для параграфів всередині цитати */
  }
  
  
  /* ==========================================================================
     MENU DROPDOWN
     ========================================================================== */
  
  .menu-dropdown {
    position: absolute;
    right: 15px;
    bottom: calc(100% + 5px); /* Розміщуємо над кнопками */
    background-color: var(--background-secondary); /* Використовуємо інший фон */
    border: 1px solid var(--background-modifier-border);
    border-radius: 8px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15); /* Більша тінь */
    z-index: 100; /* Над усім іншим */
    min-width: 180px;
    overflow: hidden;
    animation: menu-fade-in 0.15s ease-out; /* Швидша анімація */
  }
  
  @keyframes menu-fade-in {
    from { opacity: 0; transform: translateY(5px) scale(0.98); } /* Змінений ефект появи */
    to { opacity: 1; transform: translateY(0) scale(1); }
  }
  
  .menu-option {
    display: flex;
    align-items: center;
    padding: 10px 15px;
    cursor: pointer;
    transition: background-color 0.15s ease-out; /* Швидша реакція */
    color: var(--text-normal); /* Основний колір тексту */
  }
  
  .menu-option:hover {
    background-color: var(--background-modifier-hover); /* Фон при наведенні */
    color: var(--text-normal); /* Колір тексту не змінюється */
  }
  
  .menu-option-icon {
    margin-right: 12px; /* Трохи більший відступ */
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted); /* Колір іконки */
    flex-shrink: 0;
  }
  
  .menu-option-text {
    font-size: 14px;
    line-height: 1.3; /* Щоб текст не прилипав */
  }
  
  /* ==========================================================================
     RESPONSIVE DESIGN
     ========================================================================== */
  
  /* Стилі для малих екранів */
  @media screen and (max-width: 400px) {
    .chat-input-container {
       margin: 8px 10px; /* Зменшуємо бічні відступи */
       padding: 8px 10px;
    }
  
    .buttons-container {
      right: 10px; /* Трохи ближче до краю */
      gap: 5px; /* Менший простір */
    }
  
    .buttons-container button {
      width: 30px; /* Трохи менші кнопки */
      height: 30px;
    }
  
    .chat-input-container textarea {
      /* Перерахувати padding-right для менших кнопок */
      padding-right: 105px; /* Орієнтовно: (30+5)*3 + 15 */
      font-size: 13px; /* Трохи менший шрифт */
    }
  
    /* Кнопка Send може бути прихована або замінена іконкою без тексту на дуже малих екранах */
    /* .chat-input-container .send-button { display: none; } */
  
    .menu-dropdown {
      right: 10px;
      width: calc(100vw - 40px); /* Ширина меню адаптується */
      max-width: 280px;
      bottom: calc(100% + 3px); /* Ближче до кнопок */
    }
  
    .menu-option {
      padding: 12px 15px;
    }
  
    /* Зменшуємо максимальну ширину повідомлень */
    .ollama-chat-container .message {
      max-width: 88%;
    }
    .system-message,
    .error-message {
      max-width: 95%;
    }
  }
  
  /* --- Додаткові налаштування для дуже вузьких екранів (менше 360px) --- */
  @media screen and (max-width: 360px) {
      .buttons-container {
          gap: 4px;
      }
      .buttons-container button {
          width: 28px;
          height: 28px;
      }
      .chat-input-container textarea {
        padding-right: 95px; /* (28+4)*3 + 5 */
      }
  }