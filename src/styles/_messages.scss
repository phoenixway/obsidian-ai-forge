// src/styles/_messages.scss

// --- –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ (—è–∫—â–æ –≤–æ–Ω–∏ —Ç—É—Ç –≤–∏–∑–Ω–∞—á–∞—é—Ç—å—Å—è –∞–±–æ —ñ–º–ø–æ—Ä—Ç—É—é—Ç—å—Å—è) ---
// –ü—Ä–∏–ø—É—Å–∫–∞—î–º–æ, —â–æ :root –∑–º—ñ–Ω–Ω—ñ –≤–∂–µ –≤–∏–∑–Ω–∞—á–µ–Ω—ñ –≤ —ñ–Ω—à–æ–º—É –º—ñ—Å—Ü—ñ.

// --- –ó–º—ñ–Ω–Ω—ñ SASS –¥–ª—è –∑—Ä—É—á–Ω–æ—Å—Ç—ñ ---
$chat-spacing-unit: var(--chat-spacing-unit, 5px); // Fallback, —è–∫—â–æ CSS –∑–º—ñ–Ω–Ω–∞ –Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–∞
$chat-avatar-size: var(--chat-avatar-size, 32px); // Fallback
$chat-message-max-width: var(--chat-message-max-width, 700px); // Fallback
$chat-column-max-width: var(--chat-column-max-width, 1000px); // Fallback

// –ê–≤–∞—Ç–∞—Ä
$avatar-scale-factor: 1.2; // –ó–±—ñ–ª—å—à–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É –∞–≤–∞—Ç–∞—Ä–∞
$avatar-final-size: calc(#{$chat-avatar-size} * #{$avatar-scale-factor});
$avatar-font-size-factor: 0.5;
$avatar-icon-size-factor: 0.65;

// --- –ó–∞–≥–∞–ª—å–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ ---
.ollama-chat-container {
  max-width: $chat-column-max-width;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
  box-sizing: border-box; // –î–æ–±—Ä–µ –º–∞—Ç–∏ —Ü–µ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
  // padding: calc(#{$chat-spacing-unit} * 4); // –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω –∑–∞–≥–∞–ª—å–Ω–∏–π –ø–∞–¥–¥—ñ–Ω–≥
}

.message-group {
  display: flex;
  width: 100%;
  position: relative;
  box-sizing: border-box;
  align-items: flex-start; // –ó–∞–∑–≤–∏—á–∞–π –∫—Ä–∞—â–µ –¥–ª—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ –≤–∏—Ä—ñ–≤–Ω—é–≤–∞–Ω–Ω—è –∑ —Ä—ñ–∑–Ω–æ—é –≤–∏—Å–æ—Ç–æ—é –∞–≤–∞—Ç–∞—Ä–∞/–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
  gap: calc(#{$chat-spacing-unit} * 2); // –î–æ–¥–∞–º–æ gap –¥–ª—è –≤—ñ–¥—Å—Ç–∞–Ω—ñ –º—ñ–∂ –∞–≤–∞—Ç–∞—Ä–æ–º —Ç–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏
                                        // –¶–µ –∑–∞–º—ñ–Ω–∏—Ç—å –¥–µ—è–∫—ñ margin-* –Ω–∞ avatar-container
  margin-bottom: calc(#{$chat-spacing-unit} * 1); // –ó–∞–º—ñ—Å—Ç—å –∑–∞–∫–æ–º–µ–Ω—Ç–æ–≤–∞–Ω–æ–≥–æ !important

  // –í–∏—Ä—ñ–≤–Ω—é–≤–∞–Ω–Ω—è –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—ñ
  // –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ, —â–æ–± –∞–≤–∞—Ç–∞—Ä –∑–∞–≤–∂–¥–∏ –±—É–≤ –≤–Ω–∏–∑—É, –Ω–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å:
  // .avatar-container { align-self: flex-end; }
  // –Ø–∫—â–æ –≤—ñ–Ω –º–∞—î –±—É—Ç–∏ –≤–≥–æ—Ä—ñ (—è–∫ –∑–∞—Ä–∞–∑ –∑ flex-start –¥–ª—è message-group), —Ç–æ –Ω—ñ—á–æ–≥–æ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ.
}

// --- –°—Ç–∏–ª—ñ –¥–ª—è –ê–≤–∞—Ç–∞—Ä—ñ–≤ ---
.avatar-container {
  width: $avatar-final-size;
  height: $avatar-final-size;
  min-width: $avatar-final-size;
  min-height: $avatar-final-size;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  background-color: var(--background-modifier-hover); // –ó–∞–≥–∞–ª—å–Ω–∏–π —Ñ–æ–Ω
  color: var(--text-muted); // –ó–∞–≥–∞–ª—å–Ω–∏–π –∫–æ–ª—ñ—Ä –¥–ª—è —Ç–µ–∫—Å—Ç—É/—ñ–∫–æ–Ω–æ–∫
  // margin-bottom: 5px; // –ú–æ–∂–Ω–∞ –ø—Ä–∏–±—Ä–∞—Ç–∏, —è–∫—â–æ gap –≤ .message-group –¥–æ—Å—Ç–∞—Ç–Ω—ñ–π
  flex-shrink: 0; // –í–∞–∂–ª–∏–≤–æ, —â–æ–± –∞–≤–∞—Ç–∞—Ä –Ω–µ —Å—Ç–∏—Å–∫–∞–≤—Å—è

  // –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ
  img.avatar-image { // –ë—ñ–ª—å—à —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏–π —Å–µ–ª–µ–∫—Ç–æ—Ä, —è–∫—â–æ –∫–ª–∞—Å .avatar-image –Ω–∞ img
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 50%; // –î–ª—è img, —è–∫—â–æ –≤—ñ–Ω –Ω–µ —É—Å–ø–∞–¥–∫–æ–≤—É—î –≤—ñ–¥ –±–∞—Ç—å–∫–∞ –∑ overflow: hidden
  }

  // –Ü–∫–æ–Ω–∫–∞ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ (—è–∫—â–æ .avatar-icon - —Ü–µ –∫–ª–∞—Å –Ω–∞ –¥–æ—á—ñ—Ä–Ω—å–æ–º—É –µ–ª–µ–º–µ–Ω—Ç—ñ)
  .avatar-icon svg {
    width: calc(#{$avatar-final-size} * #{$avatar-icon-size-factor});
    height: calc(#{$avatar-final-size} * #{$avatar-icon-size-factor});
    display: block; // –ó–∞–±–∏—Ä–∞—î –∑–∞–π–≤–∏–π –ø—Ä–æ—Å—Ç—ñ—Ä –ø—ñ–¥ svg
  }

  // –Ü–Ω—ñ—Ü—ñ–∞–ª–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ (—è–∫—â–æ .avatar-initials - —Ü–µ –∫–ª–∞—Å –Ω–∞ –¥–æ—á—ñ—Ä–Ω—å–æ–º—É div)
  .avatar-initials {
    font-size: calc(#{$avatar-final-size} * #{$avatar-font-size-factor});
    font-weight: 600;
    line-height: 1; // –î–ª—è –∫—Ä–∞—â–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—é, flex –≤–∏—Ä—ñ–≤–Ω—é—î
    text-align: center;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
  }
}

// --- –ì—Ä—É–ø–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å: User ---
.user-message-group {
  justify-content: flex-end;

  .avatar-container {
    order: 2;
    // margin-left: calc(#{$chat-spacing-unit} * 2); // –ó–∞–º—ñ–Ω–µ–Ω–æ –Ω–∞ gap –≤ .message-group
    // –°–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏–π –∫–æ–ª—ñ—Ä –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
    background-color: var(--interactive-accent-translucent); // –ü—Ä–∏–∫–ª–∞–¥
    color: var(--interactive-accent); // –ü—Ä–∏–∫–ª–∞–¥
  }
  .message-wrapper {
    order: 1;
    align-items: flex-end; // –í–∏—Ä—ñ–≤–Ω—é—î–º–æ –±—É–ª—å–±–∞—à–∫–∏ –ø—Ä–∞–≤–æ—Ä—É—á
  }
}

// --- –ì—Ä—É–ø–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å: Ollama (AI) ---
.ollama-message-group {
  justify-content: flex-start;

  .avatar-container {
    order: 1;
    // margin-right: calc(#{$chat-spacing-unit} * 2); // –ó–∞–º—ñ–Ω–µ–Ω–æ –Ω–∞ gap –≤ .message-group
    // margin-top: 45px; // –¶–µ–π –≤–µ–ª–∏–∫–∏–π –≤—ñ–¥—Å—Ç—É–ø –≤–∏–≥–ª—è–¥–∞—î –¥–∏–≤–Ω–æ.
                       // –Ø–∫—â–æ —Ü–µ –¥–ª—è –≤–∏—Ä—ñ–≤–Ω—é–≤–∞–Ω–Ω—è –∑ –±–∞–≥–∞—Ç–æ—Ä—è–¥–∫–æ–≤–∏–º –ø–µ—Ä—à–∏–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º,
                       // –º–æ–∂–ª–∏–≤–æ, –∫—Ä–∞—â–µ –≤–∏—Ä—ñ—à—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ align-items –Ω–∞ .message-group
                       // –∞–±–æ —á–µ—Ä–µ–∑ padding/margin –Ω–∞ –ø–µ—Ä—à–æ–º—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—ñ.
                       // –ü–æ–∫–∏ —â–æ –∑–∞–∫–æ–º–µ–Ω—Ç—É—é.
  }
  .message-wrapper {
    order: 2;
    align-items: flex-start; // –í–∏—Ä—ñ–≤–Ω—é—î–º–æ –±—É–ª—å–±–∞—à–∫–∏ –ª—ñ–≤–æ—Ä—É—á
    // margin-left: 0 !important; // –ô–º–æ–≤—ñ—Ä–Ω–æ, –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ, —è–∫—â–æ gap –ø—Ä–∞—Ü—é—î
  }
}

// --- –û–±–≥–æ—Ä—Ç–∫–∞ –¥–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å (—Å–ø—ñ–ª—å–Ω–∞) ---
.message-wrapper {
  display: flex;
  flex-direction: column;
  // –¢—É—Ç –º–æ–∂–Ω–∞ –∑–∞–¥–∞—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É —à–∏—Ä–∏–Ω—É –¥–ª—è —Å–∞–º–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å,
  // —è–∫—â–æ –≤–æ–Ω–∞ –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ --chat-message-max-width (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–ª—è –≥—Ä—É–ø–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å)
  // max-width: calc(#{$chat-message-max-width} * 0.9); // –ü—Ä–∏–∫–ª–∞–¥
}

// --- –°—Ç–∏–ª—ñ –¥–ª—è –±—É–ª—å–±–∞—à–æ–∫ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å (Message Bubble) ---
.message {
  padding: calc(#{$chat-spacing-unit} * 2) calc(#{$chat-spacing-unit} * 3);
  border-radius: 18px; // –ó–∞–≥–∞–ª—å–Ω–∏–π —Ä–∞–¥—ñ—É—Å, –±—É–¥–µ –ø–µ—Ä–µ–≤–∏–∑–Ω–∞—á–µ–Ω–æ –¥–ª—è –∫—É—Ç—ñ–≤
  width: fit-content;
  max-width: $chat-message-max-width; // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –∑–º—ñ–Ω–Ω—É
  // min-width: 50px; // –ú–æ–∂–ª–∏–≤–æ, –¥–æ–¥–∞—Ç–∏ –º—ñ–Ω—ñ–º–∞–ª—å–Ω—É —à–∏—Ä–∏–Ω—É –¥–ª—è –¥—É–∂–µ –∫–æ—Ä–æ—Ç–∫–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
  white-space: normal; // –î–æ–∑–≤–æ–ª—è—î –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç–∏ —Ç–µ–∫—Å—Ç
  overflow-wrap: break-word;
  word-break: break-word; // –î–ª—è –¥–æ–≤–≥–∏—Ö —Å–ª—ñ–≤ –±–µ–∑ –ø—Ä–æ–±—ñ–ª—ñ–≤
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
  font-size: var(--font-ui-small); // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ CSS –∑–º—ñ–Ω–Ω—É –¥–ª—è —Ä–æ–∑–º—ñ—Ä—É —à—Ä–∏—Ñ—Ç—É
  line-height: 1.5;
  transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
  margin-bottom: calc(#{$chat-spacing-unit} * 0.5); // –ù–µ–≤–µ–ª–∏–∫–∏–π –≤—ñ–¥—Å—Ç—É–ø –º—ñ–∂ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏ –≤ –≥—Ä—É–ø—ñ

  &:last-child {
    margin-bottom: 0; // –ó–∞–±–∏—Ä–∞—î–º–æ –≤—ñ–¥—Å—Ç—É–ø —É –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ –≥—Ä—É–ø—ñ
  }

  &.message-arriving {
    animation: message-appear 0.3s ease-out forwards;
  }
}

// --- –õ–æ–≥—ñ–∫–∞ –∑–∞–æ–∫—Ä—É–≥–ª–µ–Ω–Ω—è –∫—É—Ç—ñ–≤ –¥–ª—è –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å ---
// User messages
.user-message-group .message-wrapper {
  .message {
    border-top-left-radius: 18px;
    border-bottom-left-radius: 18px;

    &:first-child {
      border-top-right-radius: 18px;
    }
    &:not(:first-child) {
      border-top-right-radius: 5px; // –ì–æ—Å—Ç—Ä—ñ—à–∏–π –∫—É—Ç –∑–≤–µ—Ä—Ö—É –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö
    }
    &:last-child {
      border-bottom-right-radius: 18px;
    }
    &:not(:last-child) {
      border-bottom-right-radius: 5px; // –ì–æ—Å—Ç—Ä—ñ—à–∏–π –∫—É—Ç –∑–Ω–∏–∑—É –¥–ª—è –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö
    }
    // –Ø–∫—â–æ –≤ –≥—Ä—É–ø—ñ –ª–∏—à–µ –æ–¥–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –≤—Å—ñ –∫—É—Ç–∏ –º–∞—é—Ç—å –±—É—Ç–∏ 18px (–≤–∂–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ .message —Ç–∞ :first-child/:last-child)
  }
}

// Ollama (AI) messages
.ollama-message-group .message-wrapper {
  .message {
    border-top-right-radius: 18px;
    border-bottom-right-radius: 18px;

    &:first-child {
      border-top-left-radius: 18px;
    }
    &:not(:first-child) {
      border-top-left-radius: 5px; // –ì–æ—Å—Ç—Ä—ñ—à–∏–π –∫—É—Ç –∑–≤–µ—Ä—Ö—É –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö
    }
    &:last-child {
      border-bottom-left-radius: 18px;
    }
    &:not(:last-child) {
      border-bottom-left-radius: 5px; // –ì–æ—Å—Ç—Ä—ñ—à–∏–π –∫—É—Ç –∑–Ω–∏–∑—É –¥–ª—è –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö
    }
  }
}

// --- –°—Ç–∏–ª—ñ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö —Ä–æ–ª–µ–π –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å ---
.user-message { // –¶–µ–π –∫–ª–∞—Å –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –¥–æ .message
  background-color: var(--interactive-accent);
  color: var(--text-on-accent);
  box-shadow: 0 1px 4px rgba(var(--interactive-accent-rgb), 0.2); // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ RGB –¥–ª—è –ø—Ä–æ–∑–æ—Ä–æ—Å—Ç—ñ
  &:hover {
    box-shadow: 0 3px 7px rgba(var(--interactive-accent-rgb), 0.3);
    transform: translateY(-1px);
  }
  .message-timestamp { // –Ø–∫—â–æ timestamp –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ .user-message
    color: var(--text-on-accent);
    opacity: 0.75;
  }
}

.ollama-message { // –¶–µ–π –∫–ª–∞—Å –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –¥–æ .message
  background-color: var(--background-primary-alt);
  color: var(--text-normal);
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.06);
  &:hover {
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
    transform: translateY(-1px);
  }
  pre { // –°—Ç–∏–ª—ñ –¥–ª—è –±–ª–æ–∫—ñ–≤ –∫–æ–¥—É –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å AI
    background-color: var(--background-secondary) !important; // !important, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–±–∏—Ç–∏ —ñ–Ω—à—ñ —Å—Ç–∏–ª—ñ pre
    // –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Å—Ç–∏–ª—ñ –¥–ª—è pre, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ (padding, border-radius —Ç–æ—â–æ)
    padding: calc(#{$chat-spacing-unit} * 2);
    border-radius: var(--radius-m);
    margin-top: calc(#{$chat-spacing-unit} * 1);
    margin-bottom: calc(#{$chat-spacing-unit} * 1);
    overflow-x: auto; // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∏–π —Å–∫—Ä–æ–ª –¥–ª—è –¥–æ–≤–≥–∏—Ö —Ä—è–¥–∫—ñ–≤ –∫–æ–¥—É
  }
}


// --- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç–∞ —á–∞—Å ---
.message-content-container {
  // –¶–µ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ–ø–æ—Ç—Ä—ñ–±–Ω–∏–º, —è–∫—â–æ .message-content –Ω–∞–ø—Ä—è–º—É –≤ .message
  // –Ø–∫—â–æ –≤—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ –≤—ñ–Ω –ø–æ—Ç—Ä—ñ–±–µ–Ω –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏.
}

.message-content {
  padding-bottom: calc(#{$chat-spacing-unit} * 1); // –í—ñ–¥—Å—Ç—É–ø –∑–Ω–∏–∑—É –ø–µ—Ä–µ–¥ timestamp/–∫–Ω–æ–ø–∫–∞–º–∏
  box-sizing: border-box; // –Ø–∫—â–æ —â–µ –Ω–µ —É—Å–ø–∞–¥–∫–æ–≤–∞–Ω–æ
  width: 100%; // –ó–∞–ø–æ–≤–Ω—é—î .message
  white-space: normal; // –£—Å–ø–∞–¥–∫–æ–≤—É—î—Ç—å—Å—è, –∞–ª–µ –¥–ª—è —è—Å–Ω–æ—Å—Ç—ñ
  p {
    margin-bottom: calc(var(--p-spacing) / 2); // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ CSS –∑–º—ñ–Ω–Ω—É --p-spacing
    &:last-child {
      margin-bottom: 0;
    }
  }
  // overflow-wrap —Ç–∞ word-break –≤–∂–µ —î –Ω–∞ .message
}

.message-timestamp {
  font-size: 0.75em; // –ê–±–æ var(--font-ui-smaller)
  color: var(--text-faint);
  margin-top: $chat-spacing-unit;
  text-align: right;
  display: block; // –©–æ–± –∑–∞–π–º–∞–≤ –≤—Å—é —à–∏—Ä–∏–Ω—É —ñ text-align —Å–ø—Ä–∞—Ü—é–≤–∞–≤
  width: 100%;
  opacity: 0.9;
}


// --- –ö–Ω–æ–ø–∫–∏ –¥—ñ–π (Message Actions) ---
.message-actions-wrapper {
  display: flex;
  gap: calc(#{$chat-spacing-unit} * 1.5);
  // width: fit-content; // –ó–∞–ª–∏—à–∏–º–æ, —è–∫—â–æ –∫–Ω–æ–ø–∫–∏ –º–∞—é—Ç—å –±—É—Ç–∏ –∫–æ–º–ø–∞–∫—Ç–Ω–∏–º–∏
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.2s ease-in-out, visibility 0s linear 0.2s;
  z-index: 6; // –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ —Ü–µ –≤–∏—â–µ –∑–∞ —ñ–Ω—à—ñ –µ–ª–µ–º–µ–Ω—Ç–∏
  
  // –†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è –≤—ñ–¥–Ω–æ—Å–Ω–æ .message –∞–±–æ .message-wrapper
  // –ü—Ä–∏–∫–ª–∞–¥: –ø–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è –ø—Ä–∞–≤–æ—Ä—É—á –≤—ñ–¥ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∞–±–æ –ø—ñ–¥ –Ω–∏–º
  // margin-left: $chat-spacing-unit; // –Ø–∫—â–æ –ø—Ä–∞–≤–æ—Ä—É—á
  // margin-top: $chat-spacing-unit; // –Ø–∫—â–æ –ø—ñ–¥ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º

  button.message-action-button { // –°–ø—ñ–ª—å–Ω–∏–π –∫–ª–∞—Å –¥–ª—è –≤—Å—ñ—Ö –∫–Ω–æ–ø–æ–∫ –¥—ñ–π
    background: transparent !important; // –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–±–∏—Ç–∏ —Å—Ç–∏–ª—ñ –∫–Ω–æ–ø–æ–∫ Obsidian
    border: none;
    box-shadow: none;
    // backdrop-filter: none; // –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤—Å—è
    padding: calc(#{$chat-spacing-unit} * 0.5); // –ó—Ä–æ–±–∏–º–æ —Ç—Ä–æ—Ö–∏ –±—ñ–ª—å—à–∏–π padding
    color: var(--text-muted);
    border-radius: var(--radius-s);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.15s ease;

    .svg-icon {
      width: 14px; // –ê–±–æ var(--icon-s)
      height: 14px;
    }

    &:hover {
      background: var(--background-modifier-hover) !important; // –§–æ–Ω –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ
      color: var(--text-normal);
      transform: scale(1.05);
    }
  }

  // –°–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ —Å—Ç–∏–ª—ñ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è
  button.delete-message-button {
    &.danger-option { // –Ø–∫—â–æ —Ü–µ–π –∫–ª–∞—Å –¥–æ–¥–∞—î—Ç—å—Å—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ
      color: var(--text-error);
      &:hover {
        color: var(--text-on-accent); // –ê–±–æ var(--text-error-hover)
        background-color: var(--background-modifier-error-hover) !important;
        // border-color: transparent; // –ó–∞–∑–≤–∏—á–∞–π –Ω–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω, —è–∫—â–æ border: none
      }
    }
  }
}

// –ü–æ—è–≤–∞ –∫–Ω–æ–ø–æ–∫ –¥—ñ–π –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ –Ω–∞ –æ–±–≥–æ—Ä—Ç–∫—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
// –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ .message-wrapper –æ—Ö–æ–ø–ª—é—î —ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —ñ –º—ñ—Å—Ü–µ –¥–ª—è –∫–Ω–æ–ø–æ–∫
.message-wrapper:hover .message-actions-wrapper {
  opacity: 1;
  visibility: visible;
  transition-delay: 0s; // –ó'—è–≤–ª—è—é—Ç—å—Å—è –æ–¥—Ä–∞–∑—É –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ
}

// –°—Ç–∏–ª—ñ –∫–Ω–æ–ø–æ–∫ –¥—ñ–π –¥–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (—è–∫—â–æ –≤–æ–Ω–∏ –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è)
// –Ø–∫—â–æ background –ø—Ä–æ–∑–æ—Ä–∏–π, —Ç–æ –∫–æ–ª—ñ—Ä —Ç–µ–∫—Å—Ç—É –º–∞—î –±—É—Ç–∏ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–∏–º
.user-message-group .message-actions-wrapper button.message-action-button {
  color: rgba(255, 255, 255, 0.8); // –ü—Ä–∏–∫–ª–∞–¥ –¥–ª—è —Ç–µ–º–Ω–æ–≥–æ —Ñ–æ–Ω—É .user-message
  &:hover {
    background-color: rgba(255, 255, 255, 0.15) !important;
    color: white;
  }
  // –°–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∞ –∫–Ω–æ–ø–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –¥–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
  &.delete-message-button.danger-option {
    color: rgba(255, 150, 150, 0.8); // –°–≤—ñ—Ç–ª—ñ—à–∏–π —á–µ—Ä–≤–æ–Ω–∏–π –¥–ª—è —Ç–µ–º–Ω–æ–≥–æ —Ñ–æ–Ω—É
    &:hover {
      background-color: rgba(200, 50, 50, 0.5) !important;
      color: white;
    }
  }
}

// –ó–∞–ª–∏—à–æ–∫ —Ç–≤–æ—ó—Ö —Å—Ç–∏–ª—ñ–≤ (regenerate, summarize, collapsible, show-more, animations, media queries, scroll-to-bottom, date-separator, tool-usage)
// –ü–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —ó—Ö –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–æ, —è–∫—â–æ —Ç–∞–º —î —â–æ –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏.
// –Ø –∑–∞–ª–∏—à—É —ó—Ö –ø–æ–∫–∏ —â–æ –±–µ–∑ –∑–º—ñ–Ω, —â–æ–± —Ñ–æ–∫—É—Å—É–≤–∞—Ç–∏—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ñ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å.

// ... (–¢–≤–æ—ó —Å—Ç–∏–ª—ñ –¥–ª—è .regenerate-button, .summary-modal-content, .message-content-collapsible, etc.) ...

// --- –ê–Ω—ñ–º–∞—Ü—ñ—ó ---
@keyframes message-appear {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

// --- –ö–Ω–æ–ø–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è ---
.button-loading { // –ó–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –¥–æ –∫–Ω–æ–ø–∫–∏
  .svg-icon { // –Ø–∫—â–æ —ñ–∫–æ–Ω–∫–∞ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–Ω–æ–ø–∫–∏
    animation: spin 1s linear infinite;
  }
}

// --- –†–æ–∑–¥—ñ–ª—é–≤–∞—á –¥–∞—Ç–∏ ---
.chat-date-separator {
  width: fit-content;
  max-width: 80%; // –ê–±–æ —Ñ—ñ–∫—Å–æ–≤–∞–Ω–∞ —à–∏—Ä–∏–Ω–∞
  margin: calc(#{$chat-spacing-unit} * 6) auto calc(#{$chat-spacing-unit} * 4) auto;
  padding: calc(#{$chat-spacing-unit} * 0.75) calc(#{$chat-spacing-unit} * 2.5);
  font-size: var(--font-ui-smaller);
  color: var(--text-muted);
  background-color: var(--background-secondary);
  border-radius: var(--radius-l); // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π CSS –∑–º—ñ–Ω–Ω—ñ –¥–ª—è —Ä–∞–¥—ñ—É—Å—ñ–≤, —è–∫—â–æ –≤–æ–Ω–∏ —î
  text-align: center;
  user-select: none;
  font-weight: 500;
}

// --- –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ ---
.assistant-tool-usage-indicator {
  font-style: italic;
  color: var(--text-faint);
  font-size: var(--font-ui-smaller);
  margin-top: calc(#{$chat-spacing-unit} * 0.5);
  // &::before { content: "üõ†Ô∏è "; } // –ü—Ä–∏–∫–ª–∞–¥ –∑ —ñ–∫–æ–Ω–∫–æ—é
}


// --- –ú–µ–¥—ñ–∞-–∑–∞–ø–∏—Ç–∏ —Ç–∞ —ñ–Ω—à–µ ---
// ... (–¢–≤–æ—ó –º–µ–¥—ñ–∞-–∑–∞–ø–∏—Ç–∏ –¥–ª—è .ollama-chat-container) ...
// ... (–¢–≤–æ—ó —Å—Ç–∏–ª—ñ –¥–ª—è .scroll-to-bottom-button) ...