// src/styles/_sidebar.scss
// Styles for the Ollama sidebar panel and its accordion sections

// --- Sidebar Panel (Hosts Accordion) ---
// ЗМІНЕНО СЕЛЕКТОР
.ollama-sidebar-container {
    display: flex;
    flex-direction: column; // Vertical layout for headers and content sections
    width: var(--ai-forge-sidebar-width, 250px); // Sidebar width
    min-width: var(--ai-forge-sidebar-width, 250px); // Prevent shrinking below width
    flex-shrink: 0; // Prevent shrinking
    background-color: var(--background-secondary);
    border-right: 1px solid var(--divider-color);
    height: 100%; // Take full height of parent container
    overflow: hidden; // Panel itself DOES NOT scroll
    box-sizing: border-box;
    padding: var(--size-4-2); // Невеликий відступ
    margin-right: var(--size-4-2); // Відступ від чату
    transition: width 0.24s ease-out, min-width 0.25s ease-out, opacity 0.25s ease-out, padding 0.25s ease-out, margin 0.25s ease-out, border 0.25s ease-out;

    // Separator BETWEEN accordion sections (direct child)
    // Селектор > hr підійде, якщо hr додається напряму в containerEl
     > hr.menu-separator {
         margin: calc(var(--chat-spacing-unit) * 1.5) calc(var(--chat-spacing-unit) * 1.5);
         border: none;
         border-top: 1px solid var(--divider-color);
         height: 0;
         flex-shrink: 0;
    }

    // --- ДОДАНО ПРАВИЛО ПРИХОВУВАННЯ ---
    // Стилі для прихованого стану (коли view у бічній панелі Obsidian)
    &.internal-sidebar-hidden {
        width: 0 !important;
        min-width: 0 !important;
        opacity: 0 !important;
        padding: 0 !important;
        margin: 0 !important;
        border: none !important;
        overflow: hidden !important;
        pointer-events: none !important;
    }
    // --- КІНЕЦЬ ДОДАНОГО ПРАВИЛА ---
}
// --- End Sidebar Panel ---


// --- Sidebar Accordion Sections ---

// Обгортки секцій (якщо ви їх використовуєте, як у попередньому TS коді)
.ollama-chat-panel,
.ollama-role-panel {
    display: flex;
    flex-direction: column;
}


// Header for collapsible sections (Chats, Roles)
.ollama-sidebar-section-header {
    // Inherits .menu-option class from TS for base clickable style
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    padding: calc(var(--chat-spacing-unit) * 2) calc(var(--chat-spacing-unit) * 1.5)
               calc(var(--chat-spacing-unit) * 2) calc(var(--chat-spacing-unit) * 2.5);
    user-select: none;
    cursor: pointer;
    flex-shrink: 0;
    position: relative;
    border-radius: var(--radius-s);
    margin: 1px calc(var(--chat-spacing-unit) * 1);

    &:hover {
      background-color: var(--background-modifier-hover);
    }

    .ollama-sidebar-header-left {
        display: flex;
        align-items: baseline;
        overflow: hidden;
        margin-right: var(--chat-spacing-unit);
    }

    .ollama-sidebar-section-icon {
        margin-right: 14px;
        min-width: 18px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;

        .svg-icon {
            width: 16px;
            height: 16px;
            color: var(--text-faint);
        }
    }
    &:hover .ollama-sidebar-section-icon .svg-icon {
        color: var(--text-muted);
    }

    .menu-option-text {
        font-weight: 500;
        color: var(--text-normal);
        line-height: 1.2;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .ollama-sidebar-header-button {
        padding: 2px;
        margin-left: auto;
        flex-shrink: 0;
        color: var(--text-muted);
        opacity: 0.7;
        background: none; border: none; box-shadow: none;

        &:hover {
            color: var(--text-normal);
            opacity: 1;
            background-color: var(--background-modifier-hover);
        }
        .svg-icon { width: 18px; height: 18px; }
    }
}

// Content area for collapsible sections (holds the lists)
.ollama-sidebar-section-content {
    overflow: hidden;
    max-height: 0; // Collapsed by default
    transition: max-height 0.3s ease-out, padding 0.3s ease-out, opacity 0.3s ease-out;
    box-sizing: border-box;
    padding: 0 calc(var(--chat-spacing-unit) * 1.5);
    min-height: 0;
    padding-top: 0;
    padding-bottom: 0;
    opacity: 0; // Починаємо прозорим

    // Expanded state
    &.is-expanded {
        max-height: 70vh; // Limit height
        overflow-y: auto; // Enable scroll if needed
        padding-top: var(--size-4-1);
        padding-bottom: var(--size-4-1);
        opacity: 1; // Make visible
    }

    // Scrollbar styling
    &::-webkit-scrollbar { width: 6px; }
    &::-webkit-scrollbar-track { background: transparent; margin: 2px 0; }
    &::-webkit-scrollbar-thumb { background-color: var(--background-modifier-border); border-radius: 3px; }
    &::-webkit-scrollbar-thumb:hover { background-color: var(--interactive-accent-translucent); }

    // --- Styles for elements INSIDE the content lists ---
    .ollama-role-panel-item,
    .ollama-chat-list-item { // Використовуємо більш специфічний клас для чатів
        &.menu-option {
            display: flex;
            align-items: center;
            padding: calc(var(--chat-spacing-unit) * 1.8) calc(var(--chat-spacing-unit) * 1.5);
            margin: 1px 0;
            cursor: pointer;
            border-radius: var(--radius-s);
            position: relative; // Для позиціонування кнопки "..."

            &:hover {
                background-color: var(--background-modifier-hover);
            }

            .menu-option-icon {
                margin-right: 10px;
                min-width: 16px;
                display: flex;
                align-items: center;
                justify-content: center;
                flex-shrink: 0;
                .svg-icon { width: 15px; height: 15px; }
            }

            .menu-option-text { // Для ролей
                font-size: calc(var(--font-ui-small) * 0.95);
                white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
                flex-grow: 1;
            }

            &.is-active {
                background-color: var(--interactive-accent-translucent);
                .menu-option-icon { color: var(--interactive-accent); }
                &:hover { background-color: var(--interactive-accent-translucent); filter: brightness(1.1); }
            }
            &.is-custom .menu-option-icon:not(:has(.svg-icon[icon-name="check"])) {
                color: var(--text-faint);
            }

            // Специфічно для елементів списку чатів
            .ollama-chat-item-text-wrapper {
                display: flex;
                flex-direction: column;
                flex-grow: 1;
                overflow: hidden;
                margin-right: 28px; // Збільшуємо відступ справа для кнопки "..."
                line-height: 1.3;
                gap: 1px;

                 .chat-panel-item-name {
                     font-size: calc(var(--font-ui-small) * 0.95);
                     white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
                 }
                 .chat-panel-item-date {
                     font-size: var(--font-ui-smaller);
                     color: var(--text-faint);
                     white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
                     opacity: 0.9;
                     margin-top: 2px;
                 }
            }
            // Кнопка "..." в елементі чату
            .ollama-chat-item-options {
                position: absolute; // Позиціонуємо абсолютно
                right: calc(var(--chat-spacing-unit) * 1); // Відступ справа
                top: 50%;
                transform: translateY(-50%); // Центруємо вертикально
                padding: 3px; margin: 0; flex-shrink: 0; opacity: 0; // Починаємо невидимою
                transition: opacity 0.15s ease-in-out; border-radius: var(--radius-s);
                background: none; border: none; color: var(--text-muted);
                &:hover { background-color: var(--background-modifier-hover); color: var(--text-normal); }
                .svg-icon { width: 18px; height: 18px; }
            }
            // Показуємо кнопку "..." при наведенні на елемент списку
            &:hover .ollama-chat-item-options { opacity: 0.7; &:hover { opacity: 1; } }

            // Active state text colors specific to chat item structure
            &.is-active {
                 .chat-panel-item-name { color: var(--text-accent-hover); font-weight: 500; }
                 .chat-panel-item-date { color: var(--text-accent-hover); opacity: 0.8; }
            }

        }
    }

    // Empty list message
     .menu-info-text {
        padding: calc(var(--chat-spacing-unit) * 1.8) calc(var(--chat-spacing-unit) * 1);
        color: var(--text-faint);
        font-style: italic;
        font-size: calc(var(--font-ui-small) * 0.9);
    }
}
// --- End Sidebar Accordion Sections ---


// --- ЗМІННІ ТА СТИЛІ DANGER ВИДАЛЕНІ ЗВІДСИ ---
// Якщо вони потрібні для контекстного меню, краще додати їх
// у загальні стилі меню або використовувати інший підхід.
// :root { ... } -- ВИДАЛЕНО
// .menu-item.danger-option { ... } -- ВИДАЛЕНО
// .menu-item:has(...) { ... } -- ВИДАЛЕНО
// .menu-item[aria-label=...] { ... } -- ВИДАЛЕНО


// Клас для прихованого контенту (для JS)
.ollama-sidebar-section-content-hidden {
    max-height: 0 !important;
    padding-top: 0 !important;
    padding-bottom: 0 !important;
    opacity: 0 !important;
    overflow: hidden !important;
}