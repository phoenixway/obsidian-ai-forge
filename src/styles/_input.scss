// src/styles/_layout.scss

// Main View Container
.ollama-container {
	display: flex;
	flex-direction: row; // <<< *** CORRECTED: Use 'row' for side-by-side ***
	height: 100%;
	background-color: var(--background-secondary-alt);
	align-items: stretch;
	gap: 0;
    overflow: hidden; // Add overflow hidden to the main container to prevent layout issues
}

// --- Role Panel (Sidebar within the view) ---
.ollama-role-panel {
	display: flex; // Show by default (on desktop)
	flex-direction: column;
	width: 240px; // Adjust width as needed
	flex-shrink: 0;
	background-color: var(--background-secondary);
	border-right: 1px solid var(--divider-color);
	height: 100%;
	overflow: hidden; // Panel itself shouldn't scroll, list inside does
	box-sizing: border-box;

    // Header inside the panel
    .ollama-role-panel-header {
        padding: calc(var(--chat-spacing-unit) * 3)
            calc(var(--chat-spacing-unit) * 3)
            calc(var(--chat-spacing-unit) * 2);
        font-size: var(--font-ui-small);
        font-weight: 600;
        color: var(--text-muted);
        border-bottom: 1px solid var(--divider-color);
        flex-shrink: 0;
    }

    // List container inside the panel
    .ollama-role-panel-list {
        flex-grow: 1; // Takes remaining vertical space
        overflow-y: auto; // Allows list scrolling
        padding: calc(var(--chat-spacing-unit) * 2)
            calc(var(--chat-spacing-unit) * 1.5);
        min-height: 0; // Allow shrinking within flex parent

        // Scrollbar styles
        &::-webkit-scrollbar { width: 6px; }
        &::-webkit-scrollbar-track { background: transparent; margin: 4px 0; }
        &::-webkit-scrollbar-thumb { background-color: var(--background-modifier-border); border-radius: 3px; }
        &::-webkit-scrollbar-thumb:hover { background-color: var(--interactive-accent-translucent); }

        // Separator
        hr.menu-separator {
            margin: calc(var(--chat-spacing-unit) * 1.5)
                calc(var(--chat-spacing-unit) * 1.5);
        }
    }

    // List item styles (using .menu-option base)
    .ollama-role-panel-item {
        &.menu-option {
            padding: calc(var(--chat-spacing-unit) * 1.8)
                calc(var(--chat-spacing-unit) * 2.5);
            margin: 2px 0;
            cursor: pointer;
            border-radius: var(--radius-s); // Use theme radius

            &:hover {
                background-color: var(--background-modifier-hover);
            }

            .menu-option-icon {
                margin-right: 10px;
                min-width: 16px;
                display: flex; // Center icon properly
                align-items: center;
                justify-content: center;
                .svg-icon { width: 15px; height: 15px; }
            }

            .menu-option-text {
                font-size: calc(var(--font-ui-small) * 0.95);
                white-space: nowrap; // Prevent wrapping
                overflow: hidden;
                text-overflow: ellipsis;
            }

            // Active state
            &.is-active {
                background-color: var(--interactive-accent-translucent);
                color: var(--text-accent-hover);
                .menu-option-text { font-weight: 500; color: var(--text-accent-hover); }
                .menu-option-icon { color: var(--interactive-accent); }
                &:hover { background-color: var(--interactive-accent-translucent); filter: brightness(1.1); }
            }

            // Custom role icon state
            &.is-custom .menu-option-icon:not(:has(.svg-icon[icon-name="check"])) {
                color: var(--text-faint);
            }
        }
    }
} // --- End Role Panel ---


// --- Main Chat Area (Messages + Input) ---
.ollama-main-chat-area {
	display: flex;
	flex-direction: column;
	flex-grow: 1; // Takes remaining horizontal space
	height: 100%; // Takes full parent height
	min-width: 0; // Allows shrinking
    overflow: hidden; // Prevents children from overflowing the main area container
}

// Container for the message list (chatContainerEl)
// Use a specific class if added in TS, otherwise rely on structure (less robust)
// Assuming TS adds class 'ollama-chat-area-content' to this element:
.ollama-chat-area-content { // Or use '> div:first-child' if you prefer
	flex-grow: 1; // Takes available vertical space
	position: relative;
	display: flex; // Needed for child flex-grow
	flex-direction: column;
    min-height: 0; // <<< *** ADDED: Allow shrinking ***
    overflow: hidden; // Hide anything overflowing *this* container (e.g. padding issues)
}

// Message list container (chatContainer)
.ollama-chat-container {
	flex-grow: 1; // Stretches vertically within its parent
	max-width: none; // Takes full width of parent
	margin-left: 0;
	margin-right: 0;
	padding: calc(var(--chat-spacing-unit) * 4); // Inner padding for messages
	overflow-y: auto; // <<< *** CRUCIAL: Allows message scrolling ***
    min-height: 0; // <<< *** ADDED: Allow shrinking ***

	// Scrollbar styles
	&::-webkit-scrollbar { width: 8px; }
	&::-webkit-scrollbar-track { background: var(--background-secondary); border-radius: 4px; margin: 4px 0; }
	&::-webkit-scrollbar-thumb { background-color: var(--background-modifier-border); border-radius: 4px; border: 2px solid var(--background-secondary); }
	&::-webkit-scrollbar-thumb:hover { background-color: var(--interactive-accent-translucent); }
}

// Input container (inputContainer)
.chat-input-container {
	flex-shrink: 0; // Doesn't shrink vertically
	max-width: none;
	margin-left: 0;
	margin-right: 0;
	width: 100%; // Takes full width of parent
	box-sizing: border-box; // Ensure padding is included in width

	// Reset styles specific to non-flex layout if needed (from responsive)
	border-radius: 0;
	border-top: 1px solid var(--divider-color);
	border-left: none; // Assuming panel is on the left
    padding: calc(var(--chat-spacing-unit) * 2) calc(var(--chat-spacing-unit) * 3); // Adjust padding as needed

    // Ensure textarea inside behaves
    textarea {
        max-width: 100%; // Ensure it doesn't overflow horizontally
    }
}
// --- End Main Chat Area ---


// --- RESPONSIVE ---
@media screen and (max-width: 768px) { // Tablet and smaller
	.ollama-container {
		// Revert to vertical layout for the main container
		flex-direction: column; // Stack role panel (if shown) and chat area vertically
        overflow: visible; // Allow content to scroll normally if needed
	}

	.ollama-role-panel {
		display: none; // Hide the role panel
        width: 100%; // Reset width
        height: auto; // Reset height
        border-right: none; // Remove border
        border-bottom: 1px solid var(--divider-color); // Add bottom border if shown above chat
	}

    .ollama-main-chat-area {
        border-left: none; // Ensure no border when panel hidden
        // Height is now determined by flex-grow in column layout
        overflow: visible; // Allow internal elements (chat container, input) to manage overflow
    }

    // Restore some original styles for chat-container and input-container
    // if they were heavily modified for the desktop flex layout

    .ollama-chat-container {
         padding: calc(var(--chat-spacing-unit) * 3); // Tablet padding
         // Ensure overflow-y is still auto
         overflow-y: auto;
    }

    .chat-input-container {
        border-radius: 12px; // Restore border radius
        border-left: 1px solid var(--divider-color); // Restore border if needed
        margin-top: 10px; // Add some top margin
        width: 98%; // Restore side margins
        margin-left: auto;
        margin-right: auto;
        padding: calc(var(--chat-spacing-unit) * 2) calc(var(--chat-spacing-unit) * 3); // Restore padding
    }
}

// --- END RESPONSIVE ---


// --- (Keep other layout styles like .workspace-leaf-content, .chat-date-separator etc. if they were outside the main .ollama-container block) ---