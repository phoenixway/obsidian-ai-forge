// src/styles/_layout.scss

// Main View Container
.ollama-container {
	display: flex;
	flex-direction: row; // Горизонтальний макет: панель + чат
	height: 100%;
	background-color: var(--background-secondary-alt);
	align-items: stretch; // Розтягнути по висоті
	gap: 0;
    overflow: hidden; // Головний контейнер обрізає все, що виходить за межі
}

// --- Role Panel (Sidebar within the view) ---
.ollama-role-panel {
	display: flex; // Показати на десктопі
	flex-direction: column;
	width: 240px; // Налаштуйте ширину
	flex-shrink: 0; // Не стискати
	background-color: var(--background-secondary);
	border-right: 1px solid var(--divider-color);
	height: 100%;
	overflow: hidden; // Сама панель не скролиться
	box-sizing: border-box;

    // Header
    .ollama-role-panel-header {
        padding: calc(var(--chat-spacing-unit) * 3)
            calc(var(--chat-spacing-unit) * 3)
            calc(var(--chat-spacing-unit) * 2);
        font-size: var(--font-ui-small);
        font-weight: 600;
        color: var(--text-muted);
        border-bottom: 1px solid var(--divider-color);
        flex-shrink: 0;
    }

    // List container
    .ollama-role-panel-list {
        flex-grow: 1; // Займає вільний простір
        overflow-y: auto; // Скролінг для списку
        padding: calc(var(--chat-spacing-unit) * 2)
            calc(var(--chat-spacing-unit) * 1.5);
        min-height: 0; // Дозволяє списку стискатись у flex-контейнері

        // Scrollbar styles
        &::-webkit-scrollbar { width: 6px; }
        &::-webkit-scrollbar-track { background: transparent; margin: 4px 0; }
        &::-webkit-scrollbar-thumb { background-color: var(--background-modifier-border); border-radius: 3px; }
        &::-webkit-scrollbar-thumb:hover { background-color: var(--interactive-accent-translucent); }

        // Separator
        hr.menu-separator {
            margin: calc(var(--chat-spacing-unit) * 1.5)
                calc(var(--chat-spacing-unit) * 1.5);
        }
    }

    // List item
    .ollama-role-panel-item {
        &.menu-option { // Використовуємо спільний клас для перевикористання
            display: flex; // Додано для вирівнювання іконки/тексту
            align-items: center; // Вирівняти по вертикалі
            padding: calc(var(--chat-spacing-unit) * 1.8)
                calc(var(--chat-spacing-unit) * 2.5);
            margin: 2px 0;
            cursor: pointer;
            border-radius: var(--radius-s);

            &:hover {
                background-color: var(--background-modifier-hover);
            }

            .menu-option-icon {
                margin-right: 10px;
                min-width: 16px;
                display: flex;
                align-items: center;
                justify-content: center;
                flex-shrink: 0; // Не стискати іконку
                .svg-icon { width: 15px; height: 15px; }
            }

            .menu-option-text {
                font-size: calc(var(--font-ui-small) * 0.95);
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                flex-grow: 1; // Дозволяє тексту зайняти решту місця
            }

            // Active state
            &.is-active {
                background-color: var(--interactive-accent-translucent);
                color: var(--text-accent-hover);
                .menu-option-text { font-weight: 500; color: var(--text-accent-hover); }
                .menu-option-icon { color: var(--interactive-accent); }
                &:hover { background-color: var(--interactive-accent-translucent); filter: brightness(1.1); }
            }

            // Custom role icon state
            &.is-custom .menu-option-icon:not(:has(.svg-icon[icon-name="check"])) {
                color: var(--text-faint);
            }
        }
    }
} // --- End Role Panel ---


// --- Main Chat Area (Messages + Input) ---
.ollama-main-chat-area {
	display: flex;
	flex-direction: column; // Вертикальний макет: повідомлення зверху, ввід знизу
	flex-grow: 1; // Займає решту горизонтального простору
	height: 100%;
	min-width: 0; // Дозволяє стискатись
    overflow: hidden; // Обрізає вміст, що виходить за межі цієї області
}

// Обгортка для списку повідомлень (має клас ollama-chat-area-content в TS)
.ollama-chat-area-content {
	flex-grow: 1; // Займає доступний вертикальний простір
	position: relative;
	display: flex; // Потрібен для розтягування .ollama-chat-container
	flex-direction: column;
    min-height: 0; // Дозволяє стискатись всередині flex-батька
    overflow: hidden; // Обрізає сам контейнер повідомлень, якщо потрібно
}

// Сам список повідомлень
.ollama-chat-container {
	flex-grow: 1; // Розтягується вертикально всередині .ollama-chat-area-content
	max-width: none; // Займає всю ширину батька
	margin-left: 0;
	margin-right: 0;
	padding: calc(var(--chat-spacing-unit) * 4);
	overflow-y: auto; // Дозволяє скролінг повідомлень
    min-height: 0; // Дозволяє стискатись

	// Scrollbar styles
	&::-webkit-scrollbar { width: 8px; }
    &::-webkit-scrollbar-track { background: var(--background-secondary); border-radius: 4px; margin: 4px 0; }
    &::-webkit-scrollbar-thumb { background-color: var(--background-modifier-border); border-radius: 4px; border: 2px solid var(--background-secondary); }
    &::-webkit-scrollbar-thumb:hover { background-color: var(--interactive-accent-translucent); }
}

// Контейнер поля вводу
.chat-input-container {
    // ТІЛЬКИ СТИЛІ МАКЕТУВАННЯ В ЦЬОМУ ФАЙЛІ:
	flex-shrink: 0; // Не стискати по вертикалі
    width: 100%;    // Займає всю ширину батька
    // Стилі вигляду (padding, border, background і т.д.) мають бути в _input.scss
}
// --- End Main Chat Area ---


// --- RESPONSIVE ---
@media screen and (max-width: 768px) { // Tablet and smaller
	.ollama-container {
		// Повертаємо вертикальний макет, але все ще flex
        // (можна і block, якщо панель точно не буде показуватись зверху/знизу)
		flex-direction: column;
        overflow: visible; // Дозволити скролінг сторінки при потребі
	}

	.ollama-role-panel {
		display: none; // Приховуємо панель
        // Скидаємо стилі, які були потрібні для бічного розташування
        width: 100%;
        height: auto;
        border-right: none;
        // Можна додати border-bottom, якщо панель колись буде зверху
        // border-bottom: 1px solid var(--divider-color);
	}

    .ollama-main-chat-area {
        // Займає всю висоту контейнера, бо панель прихована
        height: 100%;
        border-left: none;
        overflow: visible; // Дозволяємо внутрішнім елементам керувати скролом
    }

    // Відновлюємо стилі контейнера вводу для мобільного вигляду
    // Ці стилі візьмуться з _input.scss, якщо там немає медіа-запитів, що їх перебивають
    // АЛЕ, якщо _input.scss не визначає border-radius, margin, width для мобільних,
    // то їх треба відновити тут:
    .chat-input-container {
        // Припускаємо, що _input.scss визначає базові стилі,
        // а responsive/_tablet.scss додає/змінює потрібне
        // Якщо ні, додайте сюди відновлення margin, width, border-radius
         margin-top: 10px; // Додати відступ зверху
    }
}
// --- END RESPONSIVE ---

// FIXME: bad code structure 
.ollama-container .message .message-content {
    user-select: text !important; // Або auto. !important може знадобитись для перевизначення
    // Також переконайтесь для коду
    pre, code {
      user-select: text !important;
    }
  }
  
  // Якщо проблема стосується тільки повідомлень користувача:
  .ollama-container .user-message .message-content {
     user-select: text !important;
  }