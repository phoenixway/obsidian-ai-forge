// src/styles/_layout.scss
// ПОВЕРНЕННЯ ДО ВНУТРІШНЬОГО СКРОЛІНГУ СЕКЦІЙ

// Main View Container
.ollama-container {
    display: flex;
    flex-direction: row;
    height: 100%;
    background-color: var(--background-secondary-alt);
    align-items: stretch;
    gap: 0;
    overflow: hidden; // ЗАЛИШАЄМО hidden тут - це нормально
}

// --- Sidebar Panel (Hosts Accordion) ---
.ollama-role-panel {
    display: flex;
    flex-direction: column; // Вертикальна організація заголовків та контенту
    width: 240px;
    flex-shrink: 0;
    background-color: var(--background-secondary);
    border-right: 1px solid var(--divider-color);
    height: 100%;
    overflow: hidden; // --- ПОВЕРНУЛИ hidden: панель НЕ скролиться ---
    box-sizing: border-box;

    // Роздільник МІЖ секціями (Chats / Roles)
     > hr.menu-separator {
         margin: calc(var(--chat-spacing-unit) * 2)
                 calc(var(--chat-spacing-unit) * 1.5);
         border: none;
         border-top: 1px solid var(--divider-color);
         height: 0;
         flex-shrink: 0; // Не стискати роздільник
    }
}
// --- End Sidebar Panel ---


// --- Sidebar Accordion Sections ---

// Header for collapsible sections (Chats, Roles)
.ollama-sidebar-section-header {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    padding: calc(var(--chat-spacing-unit) * 2) calc(var(--chat-spacing-unit) * 1.5)
               calc(var(--chat-spacing-unit) * 2) calc(var(--chat-spacing-unit) * 2.5);
    user-select: none;
    cursor: pointer;
    flex-shrink: 0; // Заголовки не стискаються
    position: relative;
    border-radius: var(--radius-s);
    margin: 1px 0;
    &:hover { background-color: var(--background-modifier-hover); }

    // Ліва частина (іконка + текст)
    .ollama-sidebar-header-left {
        display: flex;
        align-items: baseline;
        overflow: hidden;
        margin-right: var(--chat-spacing-unit);
    }

    .ollama-sidebar-section-icon {
        margin-right: 14px;
        min-width: 18px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        .svg-icon { width: 16px; height: 16px; color: var(--text-faint); }
    }
    &:hover .ollama-sidebar-section-icon .svg-icon { color: var(--text-muted); }

    .menu-option-text {
        font-weight: 500;
        color: var(--text-normal);
        line-height: 1.2;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    // Кнопка "+"
    .ollama-sidebar-header-button {
        padding: 2px;
        margin-left: auto;
        flex-shrink: 0;
        color: var(--text-muted);
        opacity: 0.7;
        background: none; border: none; box-shadow: none;
        &:hover {
            color: var(--text-normal); opacity: 1; background-color: var(--background-modifier-hover);
        }
        .svg-icon { width: 18px; height: 18px; }
    }
}

// Content area for collapsible sections
.ollama-sidebar-section-content {
    overflow: hidden; // Завжди ховати те, що виходить за межі max-height
    max-height: 0; // Згорнуто за замовчуванням
    transition: max-height 0.3s ease-out, padding 0.3s ease-out;
    box-sizing: border-box;
    padding: 0 calc(var(--chat-spacing-unit) * 1.5); // Горизонтальний паддінг
     // Не є flex-елементом, що росте
     min-height: 0;
     flex-shrink: 0; // Явно забороняємо стискатись у батьківському flex-контейнері

    // Expanded state
    &.is-expanded {
        // flex-grow: 1; // ВИДАЛЕНО
        // Встановлюємо ОБМЕЖЕННЯ висоти та внутрішній скрол
        max-height: 70vh; // <-- ПОВЕРНУЛИ обмежувач висоти (можна налаштувати)
        overflow-y: auto; // <-- ПОВЕРНУЛИ внутрішній скрол
        // Вертикальні паддінги
        padding-top: calc(var(--chat-spacing-unit) * 1);
        padding-bottom: calc(var(--chat-spacing-unit) * 1);
    }

    // Scrollbar styles (ДЛЯ ВНУТРІШНЬОГО скролу секції)
    &::-webkit-scrollbar { width: 6px; }
    &::-webkit-scrollbar-track { background: transparent; margin: 2px 0; }
    &::-webkit-scrollbar-thumb { background-color: var(--background-modifier-border); border-radius: 3px; }
    &::-webkit-scrollbar-thumb:hover { background-color: var(--interactive-accent-translucent); }

    // --- Styles for elements INSIDE the content lists ---
    // (List items, chat item layout, empty text, separator - без змін)
     .ollama-role-panel-item,
    .ollama-chat-panel-item { /* ... як було ... */ }
     .ollama-chat-panel-item { /* ... як було ... */ }
     .menu-info-text { /* ... як було ... */ }
     hr.menu-separator { /* ... як було ... */ }
}
// --- End Sidebar Accordion Sections ---


// --- Main Chat Area --- (No changes)
.ollama-main-chat-area { /* ... */ }
.ollama-chat-area-content { /* ... */ }
.ollama-chat-container { /* ... */ }
.chat-input-container { /* ... */ }
// --- End Main Chat Area ---


// --- RESPONSIVE --- (No changes)
@media screen and (max-width: 768px) { /* ... */ }
// --- END RESPONSIVE ---


// --- User Select Fix --- (No changes)
.ollama-container .message .message-content { /* ... */ }
.ollama-container .user-message .message-content { /* ... */ }