import { __awaiter } from "tslib";
import { SimpleFileAgent } from "@/examples/SimpleFileAgent"; // Приклад агента
export class AgentManager {
    constructor(plugin) {
        this.agents = new Map();
        this.plugin = plugin;
        this.registerDefaultAgents();
    }
    registerDefaultAgents() {
        const fileAgent = new SimpleFileAgent();
        this.registerAgent(fileAgent);
        // тут можна додати інших агентів
    }
    registerAgent(agent) {
        if (this.agents.has(agent.id)) {
            this.plugin.logger.warn(`[AgentManager] Agent with ID "${agent.id}" is already registered. Overwriting.`);
        }
        this.agents.set(agent.id, agent);
        this.plugin.logger.info(`[AgentManager] Registered agent: ${agent.name} (ID: ${agent.id})`);
    }
    getAgent(id) {
        return this.agents.get(id);
    }
    /**
     * Збирає визначення всіх інструментів від усіх зареєстрованих агентів.
     */
    getAllToolDefinitions() {
        let allTools = [];
        this.agents.forEach(agent => {
            try {
                const agentTools = agent.getTools();
                if (Array.isArray(agentTools)) {
                    allTools = allTools.concat(agentTools);
                }
                else {
                    this.plugin.logger.warn(`[AgentManager] Agent "${agent.name}" did not return a valid array from getTools().`);
                }
            }
            catch (error) {
                this.plugin.logger.error(`[AgentManager] Error getting tools from agent "${agent.name}":`, error);
            }
        });
        // Перевірка на унікальність імен інструментів
        const toolNames = new Set();
        const uniqueTools = allTools.filter(tool => {
            if (toolNames.has(tool.name)) {
                this.plugin.logger.warn(`[AgentManager] Duplicate tool name found: "${tool.name}". Only the first instance will be used.`);
                return false;
            }
            toolNames.add(tool.name);
            return true;
        });
        return uniqueTools;
    }
    /**
     * Виконує інструмент, знаходячи відповідний агент.
     * @param toolName Назва інструменту.
     * @param args Аргументи для інструменту (вже розпарсені з JSON-рядка).
     */
    executeTool(toolName, args) {
        return __awaiter(this, void 0, void 0, function* () {
            for (const agent of this.agents.values()) {
                const agentTool = agent.getTools().find(t => t.name === toolName);
                if (agentTool) {
                    try {
                        this.plugin.logger.info(`[AgentManager] Executing tool "<span class="math-inline">\{toolName\}" from agent "</span>{agent.name}" with args:`, args);
                        const result = yield agent.executeTool(toolName, args, this.plugin);
                        this.plugin.logger.info(`[AgentManager] Tool "${toolName}" executed successfully. Result: ${typeof result === 'string' ? result.substring(0, 100) : '[non-string result]'}...`);
                        return { success: true, result: typeof result === 'string' ? result : JSON.stringify(result) };
                    }
                    catch (e) {
                        this.plugin.logger.error(`[AgentManager] Error executing tool "<span class="math-inline">\{toolName\}" in agent "</span>{agent.name}":`, e);
                        return { success: false, result: "", error: e.message || "Unknown error during tool execution." };
                    }
                }
            }
            this.plugin.logger.warn(`[AgentManager] Tool "${toolName}" not found across all registered agents.`);
            return { success: false, result: "", error: `Tool "${toolName}" not found.` };
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQWdlbnRNYW5hZ2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiQWdlbnRNYW5hZ2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFHQSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sNEJBQTRCLENBQUMsQ0FBQyxpQkFBaUI7QUFFL0UsTUFBTSxPQUFPLFlBQVk7SUFJdkIsWUFBWSxNQUFvQjtRQUh4QixXQUFNLEdBQXdCLElBQUksR0FBRyxFQUFFLENBQUM7UUFJOUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFDckIsSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUM7SUFDL0IsQ0FBQztJQUVPLHFCQUFxQjtRQUMzQixNQUFNLFNBQVMsR0FBRyxJQUFJLGVBQWUsRUFBRSxDQUFDO1FBQ3hDLElBQUksQ0FBQyxhQUFhLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDOUIsaUNBQWlDO0lBQ3JDLENBQUM7SUFFUSxhQUFhLENBQUMsS0FBYTtRQUNoQyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDO1lBQzlCLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxpQ0FBaUMsS0FBSyxDQUFDLEVBQUUsdUNBQXVDLENBQUMsQ0FBQztRQUM1RyxDQUFDO1FBQ0QsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNqQyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsb0NBQW9DLEtBQUssQ0FBQyxJQUFJLFNBQVMsS0FBSyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDOUYsQ0FBQztJQUVNLFFBQVEsQ0FBQyxFQUFVO1FBQ3hCLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDN0IsQ0FBQztJQUVEOztP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RSxDQUFDLENBQUMsQ0FBQzt3QkFDNUksT0FBTyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDLE9BQU8sSUFBSSxzQ0FBc0MsRUFBRSxDQUFDO29CQUNwRyxDQUFDO2dCQUNILENBQUM7WUFDSCxDQUFDO1lBQ0QsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLHdCQUF3QixRQUFRLDJDQUEyQyxDQUFDLENBQUM7WUFDckcsT0FBTyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsU0FBUyxRQUFRLGNBQWMsRUFBRSxDQUFDO1FBQ2hGLENBQUM7S0FBQTtDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL2FnZW50cy9BZ2VudE1hbmFnZXIudHNcbmltcG9ydCAgT2xsYW1hUGx1Z2luIGZyb20gXCJAL21haW5cIjsgLy8g0JDQtNCw0L/RgtGD0LnRgtC1INGI0LvRj9GFXG5pbXBvcnQgeyBJQWdlbnQsIElUb29sRnVuY3Rpb24gfSBmcm9tIFwiLi9JQWdlbnRcIjtcbmltcG9ydCB7IFNpbXBsZUZpbGVBZ2VudCB9IGZyb20gXCJAL2V4YW1wbGVzL1NpbXBsZUZpbGVBZ2VudFwiOyAvLyDQn9GA0LjQutC70LDQtCDQsNCz0LXQvdGC0LBcblxuZXhwb3J0IGNsYXNzIEFnZW50TWFuYWdlciB7XG4gIHByaXZhdGUgYWdlbnRzOiBNYXA8c3RyaW5nLCBJQWdlbnQ+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIHBsdWdpbjogT2xsYW1hUGx1Z2luO1xuXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogT2xsYW1hUGx1Z2luKSB7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgdGhpcy5yZWdpc3RlckRlZmF1bHRBZ2VudHMoKTtcbiAgfVxuXG4gIHByaXZhdGUgcmVnaXN0ZXJEZWZhdWx0QWdlbnRzKCk6IHZvaWQge1xuICAgIGNvbnN0IGZpbGVBZ2VudCA9IG5ldyBTaW1wbGVGaWxlQWdlbnQoKTtcbiAgICB0aGlzLnJlZ2lzdGVyQWdlbnQoZmlsZUFnZW50KTtcbiAgICAvLyDRgtGD0YIg0LzQvtC20L3QsCDQtNC+0LTQsNGC0Lgg0ZbQvdGI0LjRhSDQsNCz0LXQvdGC0ZbQslxufVxuXG4gIHB1YmxpYyByZWdpc3RlckFnZW50KGFnZW50OiBJQWdlbnQpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5hZ2VudHMuaGFzKGFnZW50LmlkKSkge1xuICAgICAgdGhpcy5wbHVnaW4ubG9nZ2VyLndhcm4oYFtBZ2VudE1hbmFnZXJdIEFnZW50IHdpdGggSUQgXCIke2FnZW50LmlkfVwiIGlzIGFscmVhZHkgcmVnaXN0ZXJlZC4gT3ZlcndyaXRpbmcuYCk7XG4gICAgfVxuICAgIHRoaXMuYWdlbnRzLnNldChhZ2VudC5pZCwgYWdlbnQpO1xuICAgIHRoaXMucGx1Z2luLmxvZ2dlci5pbmZvKGBbQWdlbnRNYW5hZ2VyXSBSZWdpc3RlcmVkIGFnZW50OiAke2FnZW50Lm5hbWV9IChJRDogJHthZ2VudC5pZH0pYCk7XG4gIH1cblxuICBwdWJsaWMgZ2V0QWdlbnQoaWQ6IHN0cmluZyk6IElBZ2VudCB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuYWdlbnRzLmdldChpZCk7XG4gIH1cblxuICAvKipcbiAgICog0JfQsdC40YDQsNGUINCy0LjQt9C90LDRh9C10L3QvdGPINCy0YHRltGFINGW0L3RgdGC0YDRg9C80LXQvdGC0ZbQsiDQstGW0LQg0YPRgdGW0YUg0LfQsNGA0LXRlNGB0YLRgNC+0LLQsNC90LjRhSDQsNCz0LXQvdGC0ZbQsi5cbiAgICovXG4gIHB1YmxpYyBnZXRBbGxUb29sRGVmaW5pdGlvbnMoKTogSVRvb2xGdW5jdGlvbltdIHtcbiAgICBsZXQgYWxsVG9vbHM6IElUb29sRnVuY3Rpb25bXSA9IFtdO1xuICAgIHRoaXMuYWdlbnRzLmZvckVhY2goYWdlbnQgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgYWdlbnRUb29scyA9IGFnZW50LmdldFRvb2xzKCk7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGFnZW50VG9vbHMpKSB7XG4gICAgICAgICAgYWxsVG9vbHMgPSBhbGxUb29scy5jb25jYXQoYWdlbnRUb29scyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4ubG9nZ2VyLndhcm4oYFtBZ2VudE1hbmFnZXJdIEFnZW50IFwiJHthZ2VudC5uYW1lfVwiIGRpZCBub3QgcmV0dXJuIGEgdmFsaWQgYXJyYXkgZnJvbSBnZXRUb29scygpLmApO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICB0aGlzLnBsdWdpbi5sb2dnZXIuZXJyb3IoYFtBZ2VudE1hbmFnZXJdIEVycm9yIGdldHRpbmcgdG9vbHMgZnJvbSBhZ2VudCBcIiR7YWdlbnQubmFtZX1cIjpgLCBlcnJvcik7XG4gICAgICB9XG4gICAgfSk7XG4gICAgLy8g0J/QtdGA0LXQstGW0YDQutCwINC90LAg0YPQvdGW0LrQsNC70YzQvdGW0YHRgtGMINGW0LzQtdC9INGW0L3RgdGC0YDRg9C80LXQvdGC0ZbQslxuICAgIGNvbnN0IHRvb2xOYW1lcyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICAgIGNvbnN0IHVuaXF1ZVRvb2xzID0gYWxsVG9vbHMuZmlsdGVyKHRvb2wgPT4ge1xuICAgICAgaWYgKHRvb2xOYW1lcy5oYXModG9vbC5uYW1lKSkge1xuICAgICAgICB0aGlzLnBsdWdpbi5sb2dnZXIud2FybihgW0FnZW50TWFuYWdlcl0gRHVwbGljYXRlIHRvb2wgbmFtZSBmb3VuZDogXCIke3Rvb2wubmFtZX1cIi4gT25seSB0aGUgZmlyc3QgaW5zdGFuY2Ugd2lsbCBiZSB1c2VkLmApO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICB0b29sTmFtZXMuYWRkKHRvb2wubmFtZSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gdW5pcXVlVG9vbHM7XG4gIH1cblxuICAvKipcbiAgICog0JLQuNC60L7QvdGD0ZQg0ZbQvdGB0YLRgNGD0LzQtdC90YIsINC30L3QsNGF0L7QtNGP0YfQuCDQstGW0LTQv9C+0LLRltC00L3QuNC5INCw0LPQtdC90YIuXG4gICAqIEBwYXJhbSB0b29sTmFtZSDQndCw0LfQstCwINGW0L3RgdGC0YDRg9C80LXQvdGC0YMuXG4gICAqIEBwYXJhbSBhcmdzINCQ0YDQs9GD0LzQtdC90YLQuCDQtNC70Y8g0ZbQvdGB0YLRgNGD0LzQtdC90YLRgyAo0LLQttC1INGA0L7Qt9C/0LDRgNGB0LXQvdGWINC3IEpTT04t0YDRj9C00LrQsCkuXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZXhlY3V0ZVRvb2wodG9vbE5hbWU6IHN0cmluZywgYXJnczogYW55KTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW4sIHJlc3VsdDogc3RyaW5nLCBlcnJvcj86IHN0cmluZyB9PiB7XG4gICAgZm9yIChjb25zdCBhZ2VudCBvZiB0aGlzLmFnZW50cy52YWx1ZXMoKSkge1xuICAgICAgY29uc3QgYWdlbnRUb29sID0gYWdlbnQuZ2V0VG9vbHMoKS5maW5kKHQgPT4gdC5uYW1lID09PSB0b29sTmFtZSk7XG4gICAgICBpZiAoYWdlbnRUb29sKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4ubG9nZ2VyLmluZm8oYFtBZ2VudE1hbmFnZXJdIEV4ZWN1dGluZyB0b29sIFwiPHNwYW4gY2xhc3M9XCJtYXRoLWlubGluZVwiPlxce3Rvb2xOYW1lXFx9XCIgZnJvbSBhZ2VudCBcIjwvc3Bhbj57YWdlbnQubmFtZX1cIiB3aXRoIGFyZ3M6YCwgYXJncyk7XG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYWdlbnQuZXhlY3V0ZVRvb2wodG9vbE5hbWUsIGFyZ3MsIHRoaXMucGx1Z2luKTtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5sb2dnZXIuaW5mbyhgW0FnZW50TWFuYWdlcl0gVG9vbCBcIiR7dG9vbE5hbWV9XCIgZXhlY3V0ZWQgc3VjY2Vzc2Z1bGx5LiBSZXN1bHQ6ICR7dHlwZW9mIHJlc3VsdCA9PT0gJ3N0cmluZycgPyByZXN1bHQuc3Vic3RyaW5nKDAsMTAwKSA6ICdbbm9uLXN0cmluZyByZXN1bHRdJyB9Li4uYCk7XG4gICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgcmVzdWx0OiB0eXBlb2YgcmVzdWx0ID09PSAnc3RyaW5nJyA/IHJlc3VsdCA6IEpTT04uc3RyaW5naWZ5KHJlc3VsdCkgfTtcbiAgICAgICAgfSBjYXRjaCAoZTogYW55KSB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4ubG9nZ2VyLmVycm9yKGBbQWdlbnRNYW5hZ2VyXSBFcnJvciBleGVjdXRpbmcgdG9vbCBcIjxzcGFuIGNsYXNzPVwibWF0aC1pbmxpbmVcIj5cXHt0b29sTmFtZVxcfVwiIGluIGFnZW50IFwiPC9zcGFuPnthZ2VudC5uYW1lfVwiOmAsIGUpO1xuICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCByZXN1bHQ6IFwiXCIsIGVycm9yOiBlLm1lc3NhZ2UgfHwgXCJVbmtub3duIGVycm9yIGR1cmluZyB0b29sIGV4ZWN1dGlvbi5cIiB9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMucGx1Z2luLmxvZ2dlci53YXJuKGBbQWdlbnRNYW5hZ2VyXSBUb29sIFwiJHt0b29sTmFtZX1cIiBub3QgZm91bmQgYWNyb3NzIGFsbCByZWdpc3RlcmVkIGFnZW50cy5gKTtcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgcmVzdWx0OiBcIlwiLCBlcnJvcjogYFRvb2wgXCIke3Rvb2xOYW1lfVwiIG5vdCBmb3VuZC5gIH07XG4gIH1cbn0iXX0=