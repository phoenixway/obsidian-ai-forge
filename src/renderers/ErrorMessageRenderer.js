// src/renderers/ErrorMessageRenderer.ts
import { BaseMessageRenderer } from "./BaseMessageRenderer";
import { CSS_CLASSES } from "../constants";
import { setIcon } from "obsidian";
// Константи, специфічні для помилок
const CSS_CLASS_ERROR_GROUP = "error-message-group";
const CSS_CLASS_ERROR_MESSAGE = "error-message"; // Клас для самої бульбашки
const CSS_CLASS_ERROR_ICON = "error-icon"; // Клас для іконки всередині
const CSS_CLASS_ERROR_TEXT = "error-message-text"; // Клас для тексту всередині
export class ErrorMessageRenderer extends BaseMessageRenderer {
    constructor(app, plugin, message, view) {
        super(app, plugin, message, view);
        if (message.role !== "error") {
            throw new Error("ErrorMessageRenderer can only render messages with role 'error'.");
        }
    }
    /**
     * Рендерить ОДНУ групу повідомлення про помилку.
     * Логіка групування та сумаризації керується ззовні (наприклад, OllamaView).
     */
    render() {
        const messageGroup = this.createMessageGroupWrapper([CSS_CLASS_ERROR_GROUP]);
        // Не додаємо аватар для помилок
        const messageWrapper = messageGroup.createDiv({ cls: "message-wrapper" });
        // messageWrapper.style.order = '2'; // Зліва, як асистент? Чи по центру?
        const { messageEl, contentContainer, contentEl } = this.createMessageBubble(messageWrapper, [CSS_CLASS_ERROR_MESSAGE]);
        contentEl.addClass(CSS_CLASS_ERROR_TEXT); // Клас для тексту помилки
        // Додаємо іконку помилки
        setIcon(contentContainer.createSpan({ cls: CSS_CLASS_ERROR_ICON, prepend: true }), "alert-triangle");
        // Встановлюємо текст помилки
        contentEl.setText(this.message.content);
        // Додаємо мітку часу
        BaseMessageRenderer.addTimestamp(messageEl, this.message.timestamp, this.view);
        // Додаємо базові кнопки дій (Copy, Delete) - опціонально для помилок?
        // this.addBaseActionButtons(messageWrapper, this.message.content);
        // Або тільки кнопку Copy?
        this.addErrorActionButtons(messageWrapper);
        return messageGroup;
    }
    /**
     * Додає кнопки дій, специфічні для повідомлення про помилку (наприклад, тільки Copy і Delete).
     * @param messageWrapper - Обгортка повідомлення (div.message-wrapper).
     */
    addErrorActionButtons(messageWrapper) {
        const buttonsWrapper = messageWrapper.createDiv({ cls: "message-actions-wrapper" });
        const finalContent = this.message.content;
        // Copy Button
        const copyBtn = buttonsWrapper.createEl("button", {
            cls: CSS_CLASSES.COPY_BUTTON,
            attr: { "aria-label": "Copy Error", title: "Copy Error" },
        });
        setIcon(copyBtn, "copy");
        this.view.registerDomEvent(copyBtn, "click", e => {
            e.stopPropagation();
            this.view.handleCopyClick(finalContent, copyBtn);
        });
        // Delete Button
        const deleteBtn = buttonsWrapper.createEl("button", {
            cls: [CSS_CLASSES.DELETE_MESSAGE_BUTTON, CSS_CLASSES.DANGER_OPTION],
            attr: { "aria-label": "Delete message", title: "Delete Message" },
        });
        setIcon(deleteBtn, "trash");
        this.view.registerDomEvent(deleteBtn, "click", e => {
            e.stopPropagation();
            this.view.handleDeleteMessageClick(this.message);
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRXJyb3JNZXNzYWdlUmVuZGVyZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJFcnJvck1lc3NhZ2VSZW5kZXJlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSx3Q0FBd0M7QUFDeEMsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDNUQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUMzQyxPQUFPLEVBQU8sT0FBTyxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBS3hDLG9DQUFvQztBQUNwQyxNQUFNLHFCQUFxQixHQUFHLHFCQUFxQixDQUFDO0FBQ3BELE1BQU0sdUJBQXVCLEdBQUcsZUFBZSxDQUFDLENBQUMsMkJBQTJCO0FBQzVFLE1BQU0sb0JBQW9CLEdBQUcsWUFBWSxDQUFDLENBQUMsNEJBQTRCO0FBQ3ZFLE1BQU0sb0JBQW9CLEdBQUcsb0JBQW9CLENBQUMsQ0FBQyw0QkFBNEI7QUFFL0UsTUFBTSxPQUFPLG9CQUFxQixTQUFRLG1CQUFtQjtJQUU1RCxZQUFZLEdBQVEsRUFBRSxNQUFvQixFQUFFLE9BQWdCLEVBQUUsSUFBZ0I7UUFDN0UsS0FBSyxDQUFDLEdBQUcsRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ2xDLElBQUksT0FBTyxDQUFDLElBQUksS0FBSyxPQUFPLEVBQUUsQ0FBQztZQUM5QixNQUFNLElBQUksS0FBSyxDQUFDLGtFQUFrRSxDQUFDLENBQUM7UUFDckYsQ0FBQztJQUNGLENBQUM7SUFFRDs7O09BR0c7SUFDSSxNQUFNO1FBQ1osTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLHlCQUF5QixDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDO1FBQzdFLGdDQUFnQztRQUVoQyxNQUFNLGNBQWMsR0FBRyxZQUFZLENBQUMsU0FBUyxDQUFDLEVBQUUsR0FBRyxFQUFFLGlCQUFpQixFQUFFLENBQUMsQ0FBQztRQUNwRSx5RUFBeUU7UUFFekUsTUFBTSxFQUFFLFNBQVMsRUFBRSxnQkFBZ0IsRUFBRSxTQUFTLEVBQUUsR0FBRyxJQUFJLENBQUMsbUJBQW1CLENBQUMsY0FBYyxFQUFFLENBQUMsdUJBQXVCLENBQUMsQ0FBQyxDQUFDO1FBQ3ZILFNBQVMsQ0FBQyxRQUFRLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLDBCQUEwQjtRQUUxRSx5QkFBeUI7UUFDekIsT0FBTyxDQUFDLGdCQUFnQixDQUFDLFVBQVUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxvQkFBb0IsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDO1FBRXJHLDZCQUE2QjtRQUM3QixTQUFTLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7UUFFeEMscUJBQXFCO1FBQ3JCLG1CQUFtQixDQUFDLFlBQVksQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQy9FLHNFQUFzRTtRQUN0RSxtRUFBbUU7UUFDN0QsMEJBQTBCO1FBQzFCLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUdqRCxPQUFPLFlBQVksQ0FBQztJQUNyQixDQUFDO0lBRUU7OztPQUdHO0lBQ00scUJBQXFCLENBQUMsY0FBMkI7UUFDNUQsTUFBTSxjQUFjLEdBQUcsY0FBYyxDQUFDLFNBQVMsQ0FBQyxFQUFFLEdBQUcsRUFBRSx5QkFBeUIsRUFBRSxDQUFDLENBQUM7UUFDOUUsTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUM7UUFFMUMsY0FBYztRQUNkLE1BQU0sT0FBTyxHQUFHLGNBQWMsQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFO1lBQzlDLEdBQUcsRUFBRSxXQUFXLENBQUMsV0FBVztZQUM1QixJQUFJLEVBQUUsRUFBRSxZQUFZLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUU7U0FDNUQsQ0FBQyxDQUFDO1FBQ0gsT0FBTyxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsQ0FBQztRQUN6QixJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDLEVBQUU7WUFDN0MsQ0FBQyxDQUFDLGVBQWUsRUFBRSxDQUFDO1lBQ3BCLElBQUksQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLFlBQVksRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNyRCxDQUFDLENBQUMsQ0FBQztRQUVILGdCQUFnQjtRQUNoQixNQUFNLFNBQVMsR0FBRyxjQUFjLENBQUMsUUFBUSxDQUFDLFFBQVEsRUFBRTtZQUNoRCxHQUFHLEVBQUUsQ0FBQyxXQUFXLENBQUMscUJBQXFCLEVBQUUsV0FBVyxDQUFDLGFBQWEsQ0FBQztZQUNuRSxJQUFJLEVBQUUsRUFBRSxZQUFZLEVBQUUsZ0JBQWdCLEVBQUUsS0FBSyxFQUFFLGdCQUFnQixFQUFFO1NBQ3BFLENBQUMsQ0FBQztRQUNILE9BQU8sQ0FBQyxTQUFTLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDNUIsSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQyxFQUFFO1lBQy9DLENBQUMsQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUNwQixJQUFJLENBQUMsSUFBSSxDQUFDLHdCQUF3QixDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNyRCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7Q0FDSiIsInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9yZW5kZXJlcnMvRXJyb3JNZXNzYWdlUmVuZGVyZXIudHNcbmltcG9ydCB7IEJhc2VNZXNzYWdlUmVuZGVyZXIgfSBmcm9tIFwiLi9CYXNlTWVzc2FnZVJlbmRlcmVyXCI7XG5pbXBvcnQgeyBDU1NfQ0xBU1NFUyB9IGZyb20gXCIuLi9jb25zdGFudHNcIjtcbmltcG9ydCB7IEFwcCwgc2V0SWNvbiB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgTWVzc2FnZSB9IGZyb20gXCIuLi90eXBlc1wiO1xuaW1wb3J0IE9sbGFtYVBsdWdpbiBmcm9tIFwiLi4vbWFpblwiO1xuaW1wb3J0IHsgT2xsYW1hVmlldyB9IGZyb20gXCIuLi9PbGxhbWFWaWV3XCI7XG5cbi8vINCa0L7QvdGB0YLQsNC90YLQuCwg0YHQv9C10YbQuNGE0ZbRh9C90ZYg0LTQu9GPINC/0L7QvNC40LvQvtC6XG5jb25zdCBDU1NfQ0xBU1NfRVJST1JfR1JPVVAgPSBcImVycm9yLW1lc3NhZ2UtZ3JvdXBcIjtcbmNvbnN0IENTU19DTEFTU19FUlJPUl9NRVNTQUdFID0gXCJlcnJvci1tZXNzYWdlXCI7IC8vINCa0LvQsNGBINC00LvRjyDRgdCw0LzQvtGXINCx0YPQu9GM0LHQsNGI0LrQuFxuY29uc3QgQ1NTX0NMQVNTX0VSUk9SX0lDT04gPSBcImVycm9yLWljb25cIjsgLy8g0JrQu9Cw0YEg0LTQu9GPINGW0LrQvtC90LrQuCDQstGB0LXRgNC10LTQuNC90ZZcbmNvbnN0IENTU19DTEFTU19FUlJPUl9URVhUID0gXCJlcnJvci1tZXNzYWdlLXRleHRcIjsgLy8g0JrQu9Cw0YEg0LTQu9GPINGC0LXQutGB0YLRgyDQstGB0LXRgNC10LTQuNC90ZZcblxuZXhwb3J0IGNsYXNzIEVycm9yTWVzc2FnZVJlbmRlcmVyIGV4dGVuZHMgQmFzZU1lc3NhZ2VSZW5kZXJlciB7XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogT2xsYW1hUGx1Z2luLCBtZXNzYWdlOiBNZXNzYWdlLCB2aWV3OiBPbGxhbWFWaWV3KSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4sIG1lc3NhZ2UsIHZpZXcpO1xuXHRcdGlmIChtZXNzYWdlLnJvbGUgIT09IFwiZXJyb3JcIikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiRXJyb3JNZXNzYWdlUmVuZGVyZXIgY2FuIG9ubHkgcmVuZGVyIG1lc3NhZ2VzIHdpdGggcm9sZSAnZXJyb3InLlwiKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICog0KDQtdC90LTQtdGA0LjRgtGMINCe0JTQndCjINCz0YDRg9C/0YMg0L/QvtCy0ZbQtNC+0LzQu9C10L3QvdGPINC/0YDQviDQv9C+0LzQuNC70LrRgy5cblx0ICog0JvQvtCz0ZbQutCwINCz0YDRg9C/0YPQstCw0L3QvdGPINGC0LAg0YHRg9C80LDRgNC40LfQsNGG0ZbRlyDQutC10YDRg9GU0YLRjNGB0Y8g0LfQt9C+0LLQvdGWICjQvdCw0L/RgNC40LrQu9Cw0LQsIE9sbGFtYVZpZXcpLlxuXHQgKi9cblx0cHVibGljIHJlbmRlcigpOiBIVE1MRWxlbWVudCB7XG5cdFx0Y29uc3QgbWVzc2FnZUdyb3VwID0gdGhpcy5jcmVhdGVNZXNzYWdlR3JvdXBXcmFwcGVyKFtDU1NfQ0xBU1NfRVJST1JfR1JPVVBdKTtcblx0XHQvLyDQndC1INC00L7QtNCw0ZTQvNC+INCw0LLQsNGC0LDRgCDQtNC70Y8g0L/QvtC80LjQu9C+0LpcblxuXHRcdGNvbnN0IG1lc3NhZ2VXcmFwcGVyID0gbWVzc2FnZUdyb3VwLmNyZWF0ZURpdih7IGNsczogXCJtZXNzYWdlLXdyYXBwZXJcIiB9KTtcbiAgICAgICAgLy8gbWVzc2FnZVdyYXBwZXIuc3R5bGUub3JkZXIgPSAnMic7IC8vINCX0LvRltCy0LAsINGP0Log0LDRgdC40YHRgtC10L3Rgj8g0KfQuCDQv9C+INGG0LXQvdGC0YDRgz9cblxuICAgICAgICBjb25zdCB7IG1lc3NhZ2VFbCwgY29udGVudENvbnRhaW5lciwgY29udGVudEVsIH0gPSB0aGlzLmNyZWF0ZU1lc3NhZ2VCdWJibGUobWVzc2FnZVdyYXBwZXIsIFtDU1NfQ0xBU1NfRVJST1JfTUVTU0FHRV0pO1xuICAgICAgICBjb250ZW50RWwuYWRkQ2xhc3MoQ1NTX0NMQVNTX0VSUk9SX1RFWFQpOyAvLyDQmtC70LDRgSDQtNC70Y8g0YLQtdC60YHRgtGDINC/0L7QvNC40LvQutC4XG5cblx0XHQvLyDQlNC+0LTQsNGU0LzQviDRltC60L7QvdC60YMg0L/QvtC80LjQu9C60Lhcblx0XHRzZXRJY29uKGNvbnRlbnRDb250YWluZXIuY3JlYXRlU3Bhbih7IGNsczogQ1NTX0NMQVNTX0VSUk9SX0lDT04sIHByZXBlbmQ6IHRydWUgfSksIFwiYWxlcnQtdHJpYW5nbGVcIik7XG5cblx0XHQvLyDQktGB0YLQsNC90L7QstC70Y7RlNC80L4g0YLQtdC60YHRgiDQv9C+0LzQuNC70LrQuFxuXHRcdGNvbnRlbnRFbC5zZXRUZXh0KHRoaXMubWVzc2FnZS5jb250ZW50KTtcblxuXHRcdC8vINCU0L7QtNCw0ZTQvNC+INC80ZbRgtC60YMg0YfQsNGB0YNcblx0XHRCYXNlTWVzc2FnZVJlbmRlcmVyLmFkZFRpbWVzdGFtcChtZXNzYWdlRWwsIHRoaXMubWVzc2FnZS50aW1lc3RhbXAsIHRoaXMudmlldyk7XG5cdFx0Ly8g0JTQvtC00LDRlNC80L4g0LHQsNC30L7QstGWINC60L3QvtC/0LrQuCDQtNGW0LkgKENvcHksIERlbGV0ZSkgLSDQvtC/0YbRltC+0L3QsNC70YzQvdC+INC00LvRjyDQv9C+0LzQuNC70L7Quj9cblx0XHQvLyB0aGlzLmFkZEJhc2VBY3Rpb25CdXR0b25zKG1lc3NhZ2VXcmFwcGVyLCB0aGlzLm1lc3NhZ2UuY29udGVudCk7XG4gICAgICAgIC8vINCQ0LHQviDRgtGW0LvRjNC60Lgg0LrQvdC+0L/QutGDIENvcHk/XG4gICAgICAgIHRoaXMuYWRkRXJyb3JBY3Rpb25CdXR0b25zKG1lc3NhZ2VXcmFwcGVyKTtcblxuXG5cdFx0cmV0dXJuIG1lc3NhZ2VHcm91cDtcblx0fVxuXG4gICAgLyoqXG4gICAgICog0JTQvtC00LDRlCDQutC90L7Qv9C60Lgg0LTRltC5LCDRgdC/0LXRhtC40YTRltGH0L3RliDQtNC70Y8g0L/QvtCy0ZbQtNC+0LzQu9C10L3QvdGPINC/0YDQviDQv9C+0LzQuNC70LrRgyAo0L3QsNC/0YDQuNC60LvQsNC0LCDRgtGW0LvRjNC60LggQ29weSDRliBEZWxldGUpLlxuICAgICAqIEBwYXJhbSBtZXNzYWdlV3JhcHBlciAtINCe0LHQs9C+0YDRgtC60LAg0L/QvtCy0ZbQtNC+0LzQu9C10L3QvdGPIChkaXYubWVzc2FnZS13cmFwcGVyKS5cbiAgICAgKi9cbiAgICAgcHJpdmF0ZSBhZGRFcnJvckFjdGlvbkJ1dHRvbnMobWVzc2FnZVdyYXBwZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG5cdFx0Y29uc3QgYnV0dG9uc1dyYXBwZXIgPSBtZXNzYWdlV3JhcHBlci5jcmVhdGVEaXYoeyBjbHM6IFwibWVzc2FnZS1hY3Rpb25zLXdyYXBwZXJcIiB9KTtcbiAgICAgICAgY29uc3QgZmluYWxDb250ZW50ID0gdGhpcy5tZXNzYWdlLmNvbnRlbnQ7XG5cbiAgICAgICAgLy8gQ29weSBCdXR0b25cbiAgICAgICAgY29uc3QgY29weUJ0biA9IGJ1dHRvbnNXcmFwcGVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcbiAgICAgICAgICAgIGNsczogQ1NTX0NMQVNTRVMuQ09QWV9CVVRUT04sXG4gICAgICAgICAgICBhdHRyOiB7IFwiYXJpYS1sYWJlbFwiOiBcIkNvcHkgRXJyb3JcIiwgdGl0bGU6IFwiQ29weSBFcnJvclwiIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBzZXRJY29uKGNvcHlCdG4sIFwiY29weVwiKTtcbiAgICAgICAgdGhpcy52aWV3LnJlZ2lzdGVyRG9tRXZlbnQoY29weUJ0biwgXCJjbGlja1wiLCBlID0+IHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnZpZXcuaGFuZGxlQ29weUNsaWNrKGZpbmFsQ29udGVudCwgY29weUJ0bik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIERlbGV0ZSBCdXR0b25cbiAgICAgICAgY29uc3QgZGVsZXRlQnRuID0gYnV0dG9uc1dyYXBwZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuICAgICAgICAgICAgY2xzOiBbQ1NTX0NMQVNTRVMuREVMRVRFX01FU1NBR0VfQlVUVE9OLCBDU1NfQ0xBU1NFUy5EQU5HRVJfT1BUSU9OXSxcbiAgICAgICAgICAgIGF0dHI6IHsgXCJhcmlhLWxhYmVsXCI6IFwiRGVsZXRlIG1lc3NhZ2VcIiwgdGl0bGU6IFwiRGVsZXRlIE1lc3NhZ2VcIiB9LFxuICAgICAgICB9KTtcbiAgICAgICAgc2V0SWNvbihkZWxldGVCdG4sIFwidHJhc2hcIik7XG4gICAgICAgIHRoaXMudmlldy5yZWdpc3RlckRvbUV2ZW50KGRlbGV0ZUJ0biwgXCJjbGlja1wiLCBlID0+IHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnZpZXcuaGFuZGxlRGVsZXRlTWVzc2FnZUNsaWNrKHRoaXMubWVzc2FnZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn0iXX0=