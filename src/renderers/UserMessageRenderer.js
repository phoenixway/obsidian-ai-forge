// src/renderers/UserMessageRenderer.ts
import { BaseMessageRenderer } from "./BaseMessageRenderer";
import { CSS_CLASSES } from "../constants";
import { setIcon } from "obsidian";
// Константи, специфічні для користувача (якщо вони потрібні окремо)
const CSS_CLASS_USER_GROUP = "user-message-group";
const CSS_CLASS_USER_MESSAGE = "user-message";
const CSS_CLASS_REGENERATE_BUTTON = "regenerate-button"; // Повинна існувати в constants.ts або тут
export class UserMessageRenderer extends BaseMessageRenderer {
    constructor(app, plugin, message, view) {
        super(app, plugin, message, view);
        if (message.role !== "user") {
            throw new Error("UserMessageRenderer can only render messages with role 'user'.");
        }
    }
    render() {
        const messageGroup = this.createMessageGroupWrapper([CSS_CLASS_USER_GROUP]);
        this.addAvatar(messageGroup, true); // true for user
        const messageWrapper = messageGroup.createDiv({ cls: "message-wrapper" });
        messageWrapper.style.order = "1"; // User messages on the right
        // Створюємо бульбашку та контейнери
        const { messageEl, contentEl } = this.createMessageBubble(messageWrapper, [CSS_CLASS_USER_MESSAGE]);
        // Render simple text content for user messages, preserving line breaks
        this.message.content.split("\n").forEach((line, i, arr) => {
            contentEl.appendText(line);
            if (i < arr.length - 1)
                contentEl.createEl("br");
        });
        // Додаємо базові кнопки (Copy, Delete) та специфічну кнопку Regenerate
        this.addUserActionButtons(messageWrapper);
        // Додаємо мітку часу
        BaseMessageRenderer.addTimestamp(messageEl, this.message.timestamp, this.view);
        return messageGroup;
    }
    /**
     * Додає кнопки дій, специфічні для повідомлення користувача (Regenerate, Copy, Delete).
     * @param messageWrapper - Обгортка повідомлення (div.message-wrapper).
     */
    addUserActionButtons(messageWrapper) {
        const buttonsWrapper = messageWrapper.createDiv({ cls: "message-actions-wrapper" });
        const finalContent = this.message.content;
        // Regenerate Button
        const regenerateBtn = buttonsWrapper.createEl("button", {
            cls: CSS_CLASS_REGENERATE_BUTTON,
            attr: { title: "Regenerate response" },
        });
        setIcon(regenerateBtn, "refresh-cw");
        this.view.registerDomEvent(regenerateBtn, "click", e => {
            e.stopPropagation();
            this.view.handleRegenerateClick(this.message); // Call view's handler
        });
        // Copy Button
        const copyBtn = buttonsWrapper.createEl("button", {
            cls: CSS_CLASSES.COPY_BUTTON, // Використовуємо константу
            attr: { "aria-label": "Copy", title: "Copy" },
        });
        setIcon(copyBtn, "copy");
        this.view.registerDomEvent(copyBtn, "click", e => {
            e.stopPropagation();
            this.view.handleCopyClick(finalContent, copyBtn);
        });
        // Delete Button
        const deleteBtn = buttonsWrapper.createEl("button", {
            cls: [CSS_CLASSES.DELETE_MESSAGE_BUTTON, CSS_CLASSES.DANGER_OPTION], // Використовуємо константи
            attr: { "aria-label": "Delete message", title: "Delete Message" },
        });
        setIcon(deleteBtn, "trash");
        this.view.registerDomEvent(deleteBtn, "click", e => {
            e.stopPropagation();
            this.view.handleDeleteMessageClick(this.message);
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVXNlck1lc3NhZ2VSZW5kZXJlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIlVzZXJNZXNzYWdlUmVuZGVyZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsdUNBQXVDO0FBQ3ZDLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQzVELE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxjQUFjLENBQUM7QUFDM0MsT0FBTyxFQUFPLE9BQU8sRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUt4QyxvRUFBb0U7QUFDcEUsTUFBTSxvQkFBb0IsR0FBRyxvQkFBb0IsQ0FBQztBQUNsRCxNQUFNLHNCQUFzQixHQUFHLGNBQWMsQ0FBQztBQUM5QyxNQUFNLDJCQUEyQixHQUFHLG1CQUFtQixDQUFDLENBQUMsMENBQTBDO0FBRW5HLE1BQU0sT0FBTyxtQkFBb0IsU0FBUSxtQkFBbUI7SUFFM0QsWUFBWSxHQUFRLEVBQUUsTUFBb0IsRUFBRSxPQUFnQixFQUFFLElBQWdCO1FBQzdFLEtBQUssQ0FBQyxHQUFHLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNsQyxJQUFJLE9BQU8sQ0FBQyxJQUFJLEtBQUssTUFBTSxFQUFFLENBQUM7WUFDN0IsTUFBTSxJQUFJLEtBQUssQ0FBQyxnRUFBZ0UsQ0FBQyxDQUFDO1FBQ25GLENBQUM7SUFDRixDQUFDO0lBRU0sTUFBTTtRQUNaLE1BQU0sWUFBWSxHQUFHLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLENBQUMsQ0FBQztRQUU1RSxJQUFJLENBQUMsU0FBUyxDQUFDLFlBQVksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLGdCQUFnQjtRQUVwRCxNQUFNLGNBQWMsR0FBRyxZQUFZLENBQUMsU0FBUyxDQUFDLEVBQUUsR0FBRyxFQUFFLGlCQUFpQixFQUFFLENBQUMsQ0FBQztRQUMxRSxjQUFjLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxH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T0FBTyxDQUFDLENBQUM7UUFDNUIsSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQyxFQUFFO1lBQy9DLENBQUMsQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUNwQixJQUFJLENBQUMsSUFBSSxDQUFDLHdCQUF3QixDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNyRCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7Q0FDSiIsInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9yZW5kZXJlcnMvVXNlck1lc3NhZ2VSZW5kZXJlci50c1xuaW1wb3J0IHsgQmFzZU1lc3NhZ2VSZW5kZXJlciB9IGZyb20gXCIuL0Jhc2VNZXNzYWdlUmVuZGVyZXJcIjtcbmltcG9ydCB7IENTU19DTEFTU0VTIH0gZnJvbSBcIi4uL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgQXBwLCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBNZXNzYWdlIH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5pbXBvcnQgT2xsYW1hUGx1Z2luIGZyb20gXCIuLi9tYWluXCI7XG5pbXBvcnQgeyBPbGxhbWFWaWV3IH0gZnJvbSBcIi4uL09sbGFtYVZpZXdcIjtcblxuLy8g0JrQvtC90YHRgtCw0L3RgtC4LCDRgdC/0LXRhtC40YTRltGH0L3RliDQtNC70Y8g0LrQvtGA0LjRgdGC0YPQstCw0YfQsCAo0Y/QutGJ0L4g0LLQvtC90Lgg0L/QvtGC0YDRltCx0L3RliDQvtC60YDQtdC80L4pXG5jb25zdCBDU1NfQ0xBU1NfVVNFUl9HUk9VUCA9IFwidXNlci1tZXNzYWdlLWdyb3VwXCI7XG5jb25zdCBDU1NfQ0xBU1NfVVNFUl9NRVNTQUdFID0gXCJ1c2VyLW1lc3NhZ2VcIjtcbmNvbnN0IENTU19DTEFTU19SRUdFTkVSQVRFX0JVVFRPTiA9IFwicmVnZW5lcmF0ZS1idXR0b25cIjsgLy8g0J/QvtCy0LjQvdC90LAg0ZbRgdC90YPQstCw0YLQuCDQsiBjb25zdGFudHMudHMg0LDQsdC+INGC0YPRglxuXG5leHBvcnQgY2xhc3MgVXNlck1lc3NhZ2VSZW5kZXJlciBleHRlbmRzIEJhc2VNZXNzYWdlUmVuZGVyZXIge1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IE9sbGFtYVBsdWdpbiwgbWVzc2FnZTogTWVzc2FnZSwgdmlldzogT2xsYW1hVmlldykge1xuXHRcdHN1cGVyKGFwcCwgcGx1Z2luLCBtZXNzYWdlLCB2aWV3KTtcblx0XHRpZiAobWVzc2FnZS5yb2xlICE9PSBcInVzZXJcIikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiVXNlck1lc3NhZ2VSZW5kZXJlciBjYW4gb25seSByZW5kZXIgbWVzc2FnZXMgd2l0aCByb2xlICd1c2VyJy5cIik7XG5cdFx0fVxuXHR9XG5cblx0cHVibGljIHJlbmRlcigpOiBIVE1MRWxlbWVudCB7XG5cdFx0Y29uc3QgbWVzc2FnZUdyb3VwID0gdGhpcy5jcmVhdGVNZXNzYWdlR3JvdXBXcmFwcGVyKFtDU1NfQ0xBU1NfVVNFUl9HUk9VUF0pO1xuXG5cdFx0dGhpcy5hZGRBdmF0YXIobWVzc2FnZUdyb3VwLCB0cnVlKTsgLy8gdHJ1ZSBmb3IgdXNlclxuXG5cdFx0Y29uc3QgbWVzc2FnZVdyYXBwZXIgPSBtZXNzYWdlR3JvdXAuY3JlYXRlRGl2KHsgY2xzOiBcIm1lc3NhZ2Utd3JhcHBlclwiIH0pO1xuXHRcdG1lc3NhZ2VXcmFwcGVyLnN0eWxlLm9yZGVyID0gXCIxXCI7IC8vIFVzZXIgbWVzc2FnZXMgb24gdGhlIHJpZ2h0XG5cbiAgICAgICAgLy8g0KHRgtCy0L7RgNGO0ZTQvNC+INCx0YPQu9GM0LHQsNGI0LrRgyDRgtCwINC60L7QvdGC0LXQudC90LXRgNC4XG4gICAgICAgIGNvbnN0IHsgbWVzc2FnZUVsLCBjb250ZW50RWwgfSA9IHRoaXMuY3JlYXRlTWVzc2FnZUJ1YmJsZShtZXNzYWdlV3JhcHBlciwgW0NTU19DTEFTU19VU0VSX01FU1NBR0VdKTtcblxuXHRcdC8vIFJlbmRlciBzaW1wbGUgdGV4dCBjb250ZW50IGZvciB1c2VyIG1lc3NhZ2VzLCBwcmVzZXJ2aW5nIGxpbmUgYnJlYWtzXG5cdFx0dGhpcy5tZXNzYWdlLmNvbnRlbnQuc3BsaXQoXCJcXG5cIikuZm9yRWFjaCgobGluZSwgaSwgYXJyKSA9PiB7XG5cdFx0XHRjb250ZW50RWwuYXBwZW5kVGV4dChsaW5lKTtcblx0XHRcdGlmIChpIDwgYXJyLmxlbmd0aCAtIDEpIGNvbnRlbnRFbC5jcmVhdGVFbChcImJyXCIpO1xuXHRcdH0pO1xuXG5cdFx0Ly8g0JTQvtC00LDRlNC80L4g0LHQsNC30L7QstGWINC60L3QvtC/0LrQuCAoQ29weSwgRGVsZXRlKSDRgtCwINGB0L/QtdGG0LjRhNGW0YfQvdGDINC60L3QvtC/0LrRgyBSZWdlbmVyYXRlXG5cdFx0dGhpcy5hZGRVc2VyQWN0aW9uQnV0dG9ucyhtZXNzYWdlV3JhcHBlcik7XG5cblx0XHQvLyDQlNC+0LTQsNGU0LzQviDQvNGW0YLQutGDINGH0LDRgdGDXG5cdFx0QmFzZU1lc3NhZ2VSZW5kZXJlci5hZGRUaW1lc3RhbXAobWVzc2FnZUVsLCB0aGlzLm1lc3NhZ2UudGltZXN0YW1wLCB0aGlzLnZpZXcpO1xuXHRcdHJldHVybiBtZXNzYWdlR3JvdXA7XG5cdH1cblxuICAgIC8qKlxuICAgICAqINCU0L7QtNCw0ZQg0LrQvdC+0L/QutC4INC00ZbQuSwg0YHQv9C10YbQuNGE0ZbRh9C90ZYg0LTQu9GPINC/0L7QstGW0LTQvtC80LvQtdC90L3RjyDQutC+0YDQuNGB0YLRg9Cy0LDRh9CwIChSZWdlbmVyYXRlLCBDb3B5LCBEZWxldGUpLlxuICAgICAqIEBwYXJhbSBtZXNzYWdlV3JhcHBlciAtINCe0LHQs9C+0YDRgtC60LAg0L/QvtCy0ZbQtNC+0LzQu9C10L3QvdGPIChkaXYubWVzc2FnZS13cmFwcGVyKS5cbiAgICAgKi9cbiAgICBwcml2YXRlIGFkZFVzZXJBY3Rpb25CdXR0b25zKG1lc3NhZ2VXcmFwcGVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuXHRcdGNvbnN0IGJ1dHRvbnNXcmFwcGVyID0gbWVzc2FnZVdyYXBwZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1lc3NhZ2UtYWN0aW9ucy13cmFwcGVyXCIgfSk7XG4gICAgICAgIGNvbnN0IGZpbmFsQ29udGVudCA9IHRoaXMubWVzc2FnZS5jb250ZW50O1xuXG4gICAgICAgIC8vIFJlZ2VuZXJhdGUgQnV0dG9uXG4gICAgICAgIGNvbnN0IHJlZ2VuZXJhdGVCdG4gPSBidXR0b25zV3JhcHBlci5jcmVhdGVFbChcImJ1dHRvblwiLCB7XG4gICAgICAgICAgICBjbHM6IENTU19DTEFTU19SRUdFTkVSQVRFX0JVVFRPTixcbiAgICAgICAgICAgIGF0dHI6IHsgdGl0bGU6IFwiUmVnZW5lcmF0ZSByZXNwb25zZVwiIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBzZXRJY29uKHJlZ2VuZXJhdGVCdG4sIFwicmVmcmVzaC1jd1wiKTtcbiAgICAgICAgdGhpcy52aWV3LnJlZ2lzdGVyRG9tRXZlbnQocmVnZW5lcmF0ZUJ0biwgXCJjbGlja1wiLCBlID0+IHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnZpZXcuaGFuZGxlUmVnZW5lcmF0ZUNsaWNrKHRoaXMubWVzc2FnZSk7IC8vIENhbGwgdmlldydzIGhhbmRsZXJcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ29weSBCdXR0b25cbiAgICAgICAgY29uc3QgY29weUJ0biA9IGJ1dHRvbnNXcmFwcGVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcbiAgICAgICAgICAgIGNsczogQ1NTX0NMQVNTRVMuQ09QWV9CVVRUT04sIC8vINCS0LjQutC+0YDQuNGB0YLQvtCy0YPRlNC80L4g0LrQvtC90YHRgtCw0L3RgtGDXG4gICAgICAgICAgICBhdHRyOiB7IFwiYXJpYS1sYWJlbFwiOiBcIkNvcHlcIiwgdGl0bGU6IFwiQ29weVwiIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBzZXRJY29uKGNvcHlCdG4sIFwiY29weVwiKTtcbiAgICAgICAgdGhpcy52aWV3LnJlZ2lzdGVyRG9tRXZlbnQoY29weUJ0biwgXCJjbGlja1wiLCBlID0+IHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnZpZXcuaGFuZGxlQ29weUNsaWNrKGZpbmFsQ29udGVudCwgY29weUJ0bik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIERlbGV0ZSBCdXR0b25cbiAgICAgICAgY29uc3QgZGVsZXRlQnRuID0gYnV0dG9uc1dyYXBwZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuICAgICAgICAgICAgY2xzOiBbQ1NTX0NMQVNTRVMuREVMRVRFX01FU1NBR0VfQlVUVE9OLCBDU1NfQ0xBU1NFUy5EQU5HRVJfT1BUSU9OXSwgLy8g0JLQuNC60L7RgNC40YHRgtC+0LLRg9GU0LzQviDQutC+0L3RgdGC0LDQvdGC0LhcbiAgICAgICAgICAgIGF0dHI6IHsgXCJhcmlhLWxhYmVsXCI6IFwiRGVsZXRlIG1lc3NhZ2VcIiwgdGl0bGU6IFwiRGVsZXRlIE1lc3NhZ2VcIiB9LFxuICAgICAgICB9KTtcbiAgICAgICAgc2V0SWNvbihkZWxldGVCdG4sIFwidHJhc2hcIik7XG4gICAgICAgIHRoaXMudmlldy5yZWdpc3RlckRvbUV2ZW50KGRlbGV0ZUJ0biwgXCJjbGlja1wiLCBlID0+IHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnZpZXcuaGFuZGxlRGVsZXRlTWVzc2FnZUNsaWNrKHRoaXMubWVzc2FnZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn0iXX0=